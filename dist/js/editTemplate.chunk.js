(window.webpackJsonp=window.webpackJsonp||[]).push([[7],[function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Search=e.RippleBtn=e.DropMenu=e.SInp=e.SComboTree=e.Tree=e.Calendar=e.SModal=e.SCombobox=e.Unit=void 0;var n,a=(n=i(9))&&n.__esModule?n:{default:n},r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();i(8),i(7),i(6),i(2);var s=i(5);function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var l=function(){function t(){o(this,t),this.tipInit()}return r(t,[{key:"JsonTofind",value:function(t,e){var i=Object.assign({},{childField:"children",keyField:"id",data:[]},t),n=i.childField,a=i.keyField,r=null;return function t(i){return i.find(function(i){var s=i[n];return i[a]===e?(r=i,!0):s.length?t(s):void 0})}(i.data),r}},{key:"tipToast",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,i='<div class="tip-item tip1">\n\t\t\t\t\t\t\t<p class="tip-close">\n\t\t\t\t\t\t\t\t<span><i class="sicon '+["sicon-error","sicon-detail","sicon-warn"][+e]+'"></i>&nbsp;'+["错误提示","成功提示","警告提示"][+e]+'</span>\n\t\t\t\t\t\t\t\t<span class="j-close"><i class="fa fa-times"></i></span>\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t<p class="tip-txt"><span>'+t+'</span></p>\n\t\t\t\t\t\t\t<div class="tip-progress"></div>\n\t\t\t\t\t\t</div>';this.$tipBox.append(i);var n=$(".tip-item:last-child");setTimeout(function(){n.remove()},6e3)}},{key:"tipInit",value:function(){this.$tipBox=$("#tipToast"),this.$tipBox.on("click",".j-close",function(){$(this).closest(".tip-item").remove()})}},{key:"openLoading",value:function(){}}]),t}(),c=function(){function t(e,i){o(this,t),this.config=Object.assign({},{serachCallback:function(){},closeCallback:function(){},childrenField:"children",keyField:"id",judgeRelation:function(){return!1},is_Arr:!0},i),this.box=e,this.data=[],this.renderSearch(),this.handle()}return r(t,[{key:"seachTree",value:function(t){var e=this.config,i=e.childrenField,n=e.keyField,a=e.judgeRelation,r=this.data;return function e(r){return r.filter(function(r){var s=r[i],o=a(r);if(r[n],o){if(s.length){var l=e(s);return(r[i]=l).length}return!1}var c=r[n].includes(t);if(s.length){var d=e(s);return(r[i]=d).length||c}return c})}(JSON.parse(JSON.stringify(r)))}},{key:"serachArr",value:function(t){var e=this.config.keyField;return this.data.filter(function(i){return i[e].includes(t)})}},{key:"renderSearch",value:function(){this.box.html('\n\t\t\t\t\t<div class="input-box">\n\t\t\t\t\t\t<input type="text" class="s-inp search-inp" id="searchInp" placeholder="搜索关键字....">\n\t\t\t\t\t\t<button class="s-btn search-btn" id="searchBtn">\n\t\t\t\t\t\t\t<span class="search-icon"></span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t\t<span class="search-close" id="searchClose">\n\t\t\t\t\t\t<i class="fa fa-times fa-2x"></i>\n\t\t\t\t\t</span> ')}},{key:"search",value:function(){return this.config.is_Arr?this.serachArr:this.seachTree}},{key:"handle",value:function(){var t=this,e=t.box,i=t.config,n=i.serachCallback,a=i.closeCallback,r=e.find(".search-inp"),s=this.search();e.on("click",".search-btn",function(){var i=e.hasClass("active-search");if(!i&&e.addClass("active-search"),i){var a=r.val().trim();if(a){var o=s.call(t,a);n(o)}}}),e.on("click",".search-close",function(){e.removeClass("active-search"),a(t.data)})}}]),t}(),d=function(){function t(e){o(this,t),this.config=Object.assign({},{opacity:.5,speed:.6,bgColor:"#fff"},e),this.els=$(".m-rippleBtn"),this.handle()}return r(t,[{key:"init",value:function(t){}},{key:"renderRipple",value:function(t,e){var i=this.getPosition(t[0],e);this.createRipple(t,i)}},{key:"getPosition",value:function(t,e){var i=t.getBoundingClientRect(),n=i.width,a=i.height,r=i.x,s=i.y,o=Math.max(n,a),l=e.clientX-r-o/2;return{radiusRange:o,top:e.clientY-s-o/2,left:l}}},{key:"createRipple",value:function(t,e){var i=e.radiusRange,n=e.top,a=e.left,r=this.config,s=r.opacity,o=r.speed,l='<span class="u-ripple" style="opacity:'+s+";background:"+r.bgColor+";animation-duration:"+o+"s;width:"+i+"px;height:"+i+"px;top:"+n+"px;left:"+a+'px"></span>';t.append(l)}},{key:"handle",value:function(){var t=this;this.els.on("click",function(e){var i=$(this);t.renderRipple(i,e)}),this.els.on("animationend",".u-ripple",function(t){$(this).remove()})}}]),t}(),u=function(){function t(e,i){o(this,t),this.config=Object.assign({},{data:[],buttonIcon:"fa fa-plus",dropIcon:"fa fa-chevron-down",buttonTxt:"新增",itemH:30,itemCallback:function(){},slideCallBack:function(){}},i),this.box=e,this.init(),this.handle()}return r(t,[{key:"init",value:function(){var t=this.renderButtons(),e='<ul class="menu-box">'+this.renderDrop().join("")+"</ul>";this.box.html(t+e)}},{key:"renderDrop",value:function(){var t=this.config,e=t.data,i=t.itemH;return e.map(function(t,e){var n=t.icon,a=t.text;return'<li class="menu-item" echo-data = \''+t.id+"' style=\"top:"+e*i+'px">\n  \t\t\t\t\t<span class="drop-icon">\n  \t\t\t\t\t\t<i class=\''+n+'\'></i>\n  \t\t\t\t\t</span>\n  \t\t\t\t\t<span class="drop-text">\n  \t\t\t\t\t\t'+a+"\n  \t\t\t\t\t</span>\n\t\t\t\t</li>"})}},{key:"renderButtons",value:function(){var t=this.config,e=t.dropIcon;return'<div class="menu-btn">\n\t\t\t\t\t<span>\n\t\t\t\t\t  <i class="'+t.buttonIcon+'"></i>\n\t\t\t\t\t\t'+t.buttonTxt+'\n\t\t\t\t\t</span>\n\t\t\t\t\t<span class="s-Divider"></span>\n\t\t\t\t\t<span class="dropmenu-icon">\n\t\t\t\t\t\t<i class="'+e+'"></i>\n\t\t\t\t\t</span>\n\t\t\t\t</div>'}},{key:"reload",value:function(t){this.config.data=t;var e=this.renderDrop().join("");this.box.find(".menu-box").html(e)}},{key:"handle",value:function(){var t=this;this.box.on("click",".menu-btn",function(){var e=$(this),i=e.parent(".drop-menu"),n=e.siblings(".menu-box");i.hasClass("active")?(i.removeClass("active"),window.requestAnimationFrame(function(){n.hide()})):(n.show(),t.config.slideCallBack(),window.requestAnimationFrame(function(){i.addClass("active")}))}),this.box.on("click",".menu-item",function(){var e=$(this);t.config.itemCallback(e),t.box.removeClass("active"),t.box.children(".menu-box").hide()})}}]),t}(),h=function(){function t(){o(this,t),this.init()}return r(t,[{key:"init",value:function(){this.handle()}},{key:"handle",value:function(){$(".s-inp-box .s-inp.s-valid").on("blur",function(){!this.value.trim()&&$(this).addClass("no-fill")||$(this).removeClass("no-fill")}),$(".num-valid").on("blur",function(){this.validity.valid?$(this).removeClass("no-fill"):$(this).addClass("no-fill")})}}]),t}(),p=function(){function t(e,i){o(this,t),this.config=Object.assign({},{prompt:"请选择...",slideIcon:"fa fa-chevron-down",data:[],dropIcon:"fa fa-circle",textField:"text",idField:"id",validCombo:!0,dropFormatter:null,multiply:!1,defaultVal:"",clickCallback:function(){},width:260,textarea:!1},i),this.box=e,this.selValue=this.config.defaultVal,this.init(),this.handle()}return r(t,[{key:"init",value:function(){var t=this.config.width;this.box.css({width:t}),this.box.html(this.initRender()),this.selValue.length&&this.updateInpBox(this.box.find(".drop-ul"))}},{key:"loadData",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.box;this.config.data=t;var i=this.renderDrop().join(""),n=e.children(".combo-drop");n.html("<ul>"+i+"</ul>"),!this.updateInpBox(n.children()).length&&this.config.validCombo&&e.children(".combo-inp").addClass("no-fill")}},{key:"initRender",value:function(){return'\n\t\t\t\t<div class="combo-inp '+(this.config.validCombo?"no-fill":"")+'" >\n\t\t\t\t\t'+this.renderInpBox()+'\n\t\t\t\t</div>\n\t\t\t\t<div class="combo-drop ">\n\t\t\t\t\t<ul class="drop-ul">\n\t\t\t\t\t\t'+this.renderDrop().join("")+"\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t\t"}},{key:"setValue",value:function(t){var e=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.box).children(".combo-drop").children("ul");this.config.multiply?e.html(this.renderDrop(t)):e.children("li[echo-id="+t+"]").addClass("active").siblings().removeClass("active"),this.updateInpBox(e)}},{key:"getValue",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.box,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"id",i=t.find(".combo-value").val();if("id"==e)return i;var n=this.config,a=(n.data,n.idField);return n.textField,this.config.data.filter(function(t){return i.includes(t[a])})}},{key:"clearValue",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.box,e=t.find(".combo-value");this.selValue="",e.val(null),e.siblings(".combo-text").val(null),this.config.validCombo&&e.parent().addClass("no-fill"),t.find(".active").removeClass("active")}},{key:"updateInpBox",value:function(t){var e=t.parent().siblings(),i=e.children(".combo-text"),n=e.children(".combo-value"),a=this.config,r=a.data,s=a.idField,o=a.textField,l=(a.multiply,a.validCombo),c=[],d=$.map(t.children(".active"),function(t,e){var i=$(t).attr("echo-id"),n=c[e]=r.find(function(t){return t[s]==i});return c[e]=n&&n[o]||"",i});return this.selValue=d,i.val(c.join(",")),n.val(d.join(",")),l&&(d.join(",")?e.removeClass("no-fill"):e.addClass("no-fill")),this.selValue}},{key:"renderInpBox",value:function(){var t=this.config,e=t.textarea,i=t.multiply,n=t.prompt,a=t.slideIcon,r=this.selValue;return"\n\t\t\t\t\t"+((e||i)&&'<textarea  class="s-textarea combo-text" placeholder="'+n+'" readOnly="readOnly"></textarea>'||'<input type="text" class="s-inp combo-text" placeholder="'+n+'" readOnly="readOnly"/>')+'\n\t\t\t\t\t<input type="hidden" class="s-inp combo-value"  value="'+(Array.isArray(r)?r.join(","):r)+'"/>\n\t\t\t\t\t<span class="slide-icon '+a+'">\n\t\t\t\t\t</span>\n\t\t\t\t'}},{key:"renderDrop",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.selValue,e=this.config,i=e.data,n=e.dropIcon,a=e.textField,r=e.idField,s=e.dropFormatter;return i.map(function(e,i){var o=e[r];return'<li class="drop-item '+(t.includes(o)?"active":"")+'" echo-id="'+o+'">\n\t\t\t\t\t\t<span class="'+n+'"></span>\n\t\t\t\t\t\t<b class="item-txt">'+(s&&s(e)||e[a])+"</b>\n\t\t\t\t\t</li>"})}},{key:"handle",value:function(){var t=this;this.box.on("click",".drop-item",function(e){e.stopPropagation();var i=$(this),n=null,a=i.hasClass("active");if(t.config.multiply)a&&i.removeClass("active")||i.addClass("active"),n=!a;else{if(a)return;n=t.getValue(),i.addClass("active").siblings().removeClass("active")}var r=i.parent();t.updateInpBox(r),!t.config.multiply&&t.hideUp(t.box);var s=i.attr("echo-id"),o=t.config.data.find(function(e){return e[t.config.idField]==s});t.config.clickCallback(o,t,n)}),this.box.on("click",".combo-inp",function(e){e.stopPropagation();var i=$(this).parent();i.hasClass("active")?t.hideUp(i):t.showDown(i)})}},{key:"showDown",value:function(t,e){t.children(".combo-drop").show(),requestAnimationFrame(function(){t.addClass("active")})}},{key:"hideUp",value:function(t){t.removeClass("active"),t.children(".combo-drop").hide()}}]),t}(),f=function(){function t(){o(this,t),this.handle()}return r(t,[{key:"init",value:function(){}},{key:"close",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"m-show";t.removeClass(e),requestAnimationFrame(function(){t.hide()})}},{key:"show",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"m-show";t.show(),requestAnimationFrame(function(){t.addClass(e)})}},{key:"handle",value:function(){var t=this;$(".m-close").click(function(e){var i=$(this).closest(".s-modal");t.close(i)});var e=null,i=null,n=null;$(".m-title").mousedown(function(t){(t.target||t.srcElement).classList.contains("m-title")&&(e="move",i=$(this).closest(".s-modal"),n={x:t.offsetX,y:t.offsetY})}),$(window).on("mousemove",function(t){if(t||window.events,e){var a=t.clientX-n.x,r=t.clientY-n.y;i[0].style.transform="translate("+a+"px,"+r+"px)",i[0].style.top=0,i[0].style.left=0}}),$(".m-title").on("mouseup",function(){n=i=e=null})}}]),t}(),m=function(){function t(e,i){o(this,t);var n={data:[],textField:"text",search:!0,idField:"id",childIcon:"fa fa-user-circle-o",parIcon:"fa fa-folder-open-o",slideIcon:"fa fa-minus-square-o",checkbox:!1,formatter:null,parClick:!1,clickCallback:function(){},checkCallback:function(){},clickAndCheck:!0,childrenField:"children",judgeRelation:function(t){return 0<t[n.childrenField].length}};this.config=Object.assign({},n,i),this.box=e,this.selArr=null,this.searchStatus=null,this.init(),this.handle()}var e,i;return r(t,[{key:"init",value:function(){this.selArr=[],this.searchStatus=!1;var t=this.config,e=t.data,i=t.search,n=this.renderOrgJson(e,0),a=i?'<div class="tree-search">\n\t\t\t\t\t\t\t\t\t<label >\n\t\t\t\t\t\t\t\t\t\t\t<input type="text" class="s-inp" placeholder="搜索..." />\n\t\t\t\t\t\t\t\t\t\t\t<span class="search-close">\n\t\t\t\t\t\t\t\t\t\t\t\t<i class="fa fa-times"></i> \n\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t\t\t<button class="s-btn j-search"><i class="fa fa-search-plus"></i></button>\n\t\t\t\t\t\t\t\t\t</div>':"";this.box.html(a+'<ul class="s-tree">'+n.join("")+"</ul>")}},{key:"changeType",value:function(t){this.config.checkbox=t,this.box.unbind(),this.init(),this.handle()}},{key:"seachTree",value:function(t){var e=this.config,i=e.data,n=e.childrenField,a=e.textField,r=e.judgeRelation;return function e(i){return i.filter(function(i){var s=i[n],o=r(i);if(i[a],o){if(s.length){var l=e(s);return(i[n]=l).length}return!1}var c=i[a].includes(t);if(s.length){var d=e(s);return(i[n]=d).length||c}return c})}(JSON.parse(JSON.stringify(i)))}},{key:"renderOrgJson",value:function(t,e){var i=this,n=e;n++;var a=this.config,r=a.idField,s=a.textField,o=a.childrenField,l=a.judgeRelation,c=a.childIcon,d=a.parIcon,u=a.formatter;return t.map(function(t,e){var a=t[r],h=!u&&t[s]||u(t),p=t[o],f=t.par_id,m=l(t),v={id:a,name:h,lev:n,par_id:f};if(m){v.parIcon=d;var b=i.renderOrgJson(p,n);return i.parentComponent(b,v)}return v.childIcon=c,i.childComponent(v)})}},{key:"reload",value:(e=a.default.mark(function t(){var e,i,n,r,s=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";return a.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=s?this.seachTree(s):this.config.data,i=this.renderOrgJson(e,0),this.box.find(".s-tree").html(i),n=this.config.idField,r=this.selArr.map(function(t){return t[n]}),this.setValue(r,!1);case 6:case"end":return t.stop()}},t,this)}),i=function(){var t=e.apply(this,arguments);return new Promise(function(e,i){return function n(a,r){try{var s=t[a](r),o=s.value}catch(a){return void i(a)}if(!s.done)return Promise.resolve(o).then(function(t){n("next",t)},function(t){n("throw",t)});e(o)}("next")})},function(){return i.apply(this,arguments)})},{key:"parentComponent",value:function(t,e){var i=e.name,n=e.id,a=e.lev,r=(e.par_id,this.config),s=r.parIcon,o=r.checkbox,l=r.slideIcon;return'\n\t\t\t<li  lev="'+a+'" class="tree-li">\n\t\t\t\t<div class="menuItem par-item" echo-id="'+n+'">\n\t\t\t\t\t'+(new Array(a).fill('<span class="indent"></span>').join("")+(o&&'<span class="s-checkbox">\n\t\t\t\t\t\t<input type="checkbox" class="par-checkinp tree-inp" value="'+n+'"  /><label class="fa fa-square-o" ></label>\n\t\t\t\t</span>'||""))+'\n\t\t\t\t\t<i class="'+s+'"></i>\n\t\t\t\t\t<span class="item-txt">'+i+'</span><span class="tree-slide-icon"><i class="'+l+'"></i></span>\n\t\t\t\t</div>\n\t\t\t\t<ul class="par-menu">'+t.join("")+"</ul>\n\t\t\t</li>\n\t\t"}},{key:"childComponent",value:function(t){var e=t.name,i=t.id,n=t.lev,a=this.config,r=a.childIcon,s=a.checkbox&&'<span class="s-checkbox">\n\t\t\t\t\t\t<input type="checkbox" class="child-checkinp tree-inp" value="'+i+'"  /><label class="fa fa-square-o" ></label>\n\t\t\t\t</span>'||"";return'\n\t\t\t<li lev="'+n+'" class="tree-li">\n\t\t\t\t<div class="menuItem child-item" echo-id="'+i+'">\n\t\t\t\t'+(new Array(n).fill('<span class="indent"></span>').join("")+s)+'\n\t\t\t\t<i class="'+r+'">&nbsp;</i>\n\t\t\t\t<span class="item-txt">'+e+"</span>\n\t\t\t\t</div>\n\t\t\t</li>\n\t\t"}},{key:"cascadeTreeInp",value:function(t,e,i){var n=t.closest(".tree-li"),a=n.attr("lev");for(e&&(n.find(".has-chec").removeClass("has-chec"),n.find(".tree-inp").prop("checked",i));1<a;){a=+(n=n.parent().parent()).attr("lev");var r=n.children(".menuItem").find(".tree-inp"),s=n.children(".par-menu"),o=s.children("li").length,l=s.children("li").children(".menuItem").find(".tree-inp:checked").length;0===l?(r.siblings("label").removeClass("has-chec"),r.prop("checked",!1)):l<o?(r.prop("checked",!1),r.siblings("label").addClass("has-chec")):(r.siblings("label").removeClass("has-chec"),r.prop("checked",!1),r.prop("checked",!0),r.siblings("label").removeClass("has-chec"));var c=n.find(".has-chec").length;0==l&&c&&(r.prop("checked",!1),r.siblings("label").addClass("has-chec"))}return this.findNode(t.val())}},{key:"upDataSelArr",value:function(t,e,i,n){var a=this,r=this.config.idField;if(i)if(this.searchStatus){var s=this.config.idField;$.map(e.parent().parent().siblings(".par-menu").find(".child-checkinp"),function(t){var e=t.value;return a.findNode(e)}).map(function(t){var e=a.selArr.findIndex(function(e){return e[s]==t[s]});n?-1==e&&a.selArr.push(t):-1<e&&a.selArr.splice(e,1)})}else{var o=$.map(this.box.find(".child-checkinp:checked"),function(t){var e=t.value;return a.findNode(e)});this.selArr=o}else if(n)this.selArr.push(t);else{var l=this.selArr.findIndex(function(e){return e[r]==t[r]});this.selArr.splice(l,1)}}},{key:"handle",value:function(){var t=this.config,e=t.clickCallback,i=t.clickAndCheck,n=t.checkbox,a=t.checkCallback,r=t.parClick,s=this;this.box.on("click",".tree-slide-icon",function(t){t.stopPropagation();var e=$(this).closest(".tree-li"),i=$(this).parent();i.hasClass("tree-active")&&i.removeClass("tree-active")||i.addClass("tree-active"),e.children(".par-menu").slideToggle()}),this.box.on("click",function(t){t.stopPropagation()}),this.box.on("click",".child-item",function(t){var a=$(this),r=s.findNode(+a.attr("echo-id"));n?i&&a.find(".tree-inp").click():(a.closest(".s-tree").find(".active").removeClass("active"),a.addClass("active"),s.selArr=[r]),e(r,a,s.selArr)}),this.box.on("click",".search-close",function(){var t=$(this);t.siblings(".s-inp").val(null),t.hide(),s.searchStatus=!1,s.reload()}),this.box.on("click",".j-search",function(){var t=$(this).siblings("label").children(".search-close");t.show();var e=t.siblings(".s-inp").val().trim();e&&(s.searchStatus=!0,s.reload(e))}),this.box.on("click",".par-item",function(){var t=$(this),a=s.findNode(+t.attr("echo-id"));n&&i&&t.find(".tree-inp").click(),n&&e(a,t),!n&&r&&(t.closest(".s-tree").find(".active").removeClass("active"),t.addClass("active"),s.selArr=[a],e(a,t,s.selArr))}),this.box.on("click",".tree-inp",function(t){t.stopPropagation();var e=$(this),i=e.prop("checked"),n=e.hasClass("par-checkinp"),r=s.cascadeTreeInp(e,n,i);s.upDataSelArr(r,e,n,i),a(r,e,s.selArr)})}},{key:"setValue",value:function(t){var e=this,i=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n=this.box;this.config.checkbox?(i&&(this.selArr=t.map(function(t){return e.findNode(t)})),n.find(".tree-inp").prop("checked",!1).removeClass("has-chec"),t.map(function(t){var i=n.find(".child-checkinp[value="+t+"]").prop("checked",!0);e.cascadeTreeInp(i,!1,!0)}),this.config.checkCallback(null,null,this.selArr)):this.setSingleValue(t)}},{key:"setSingleValue",value:function(t){(1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.box).find(".menuItem[echo-id="+t+"]").click()}},{key:"getValue",value:function(t){var e=this;if(1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.box,this.config.checkbox)return $.map(this.box.find(".child-checkinp:checked"),function(i){var n=i.value;return"id"===t&&n||e.findNode(n)});var i=this.box.find(".active").attr("echo-id");return["id"===t&&i||this.findNode(i)]}},{key:"findNode",value:function(t){var e=null,i=this.config,n=i.childrenField,a=i.idField;return function i(r){return r.find(function(r){var s=r[a]==t;return s&&(e=r),r[n].length&&!s&&i(r[n])||s})}(i.data),e}}]),t}(),v=function(){function t(e,i){o(this,t),this.config=Object.assign({},{prompt:"请选择...",slideIcon:"fa fa-chevron-down",defaultVal:"",validCombo:!0,width:300,textarea:!1},i),this.box=e,this.init()}return r(t,[{key:"init",value:function(){var t=this.config.width;this.box.css({width:t}),this.box.html(this.initRender()),this.renderDrop(),this.handle()}},{key:"initRender",value:function(){var t=!!this.config.treeConfig.checkbox;return'\n\t\t\t\t<div class="combo-inp '+(this.config.validCombo?"no-fill":"")+'">\n\t\t\t\t\t'+this.renderInpBox(t)+'\n\t\t\t\t</div>\n\t\t\t\t<div class="combo-drop ">\n\t\t\t\t\t<ul class="s-tree"></ul>\n\t\t\t\t</div>\n\t\t\t\t'}},{key:"setValue",value:function(t){1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.box,this.tree.setValue(t)}},{key:"getValue",value:function(){return this.tree.getValue("all")}},{key:"clearValue",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.box,e=t.find(".combo-value");e.val(null),e.siblings(".combo-text").val(null),this.config.validCombo&&e.parent().addClass("no-fill"),this.config.treeConfig.checkbox&&t.find(".tree-inp").prop("checked",!1).removeClass("has-chec")||t.find(".active").removeClass("active")}},{key:"updateInpBox",value:function(t){var e=this.tree.config,i=e.idField,n=e.textField,a=e.checkbox,r=this.box.find(".combo-inp"),s=r.children(".combo-text"),o=r.children(".combo-value"),l=[],c=[];a?l=this.tree.selArr.map(function(t){return c.push(t[i]),t[n]}):(l[0]=t[n],c[0]=t[i]),s.val(l.join(",")),o.val(c.join(",")),this.config.validCombo&&(0===c.length?r.addClass("no-fill"):r.removeClass("no-fill"))}},{key:"renderDrop",value:function(){var t=this,e=this.box.children(".combo-drop"),i=this.config.treeConfig,n=i.clickCallback,a=i.checkCallback,r=Object.assign({},this.config.treeConfig,{clickCallback:function(e,i){t.updateInpBox(e),!t.tree.config.checkbox&&t.hideUp(t.box),n&&n(e)},checkCallback:function(e,i){t.updateInpBox(),a&&a(e)}});this.tree=new m(e,r)}},{key:"changeType",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:this.box;this.tree.changeType(t,e),i.find(".combo-inp").html(this.renderInpBox(t)),this.config.validCombo&&i.children(".combo-inp").addClass("no-fill"),e&&this.setValue(e)}},{key:"renderInpBox",value:function(t){var e=this.config,i=e.prompt,n=e.slideIcon;return"\n\t\t\t\t\t"+((e.textarea||t)&&'<textarea type="text" class="s-textarea combo-text" placeholder="'+i+'" readOnly="readOnly"/></textarea>'||'<input type="text" class="s-inp combo-text" placeholder="'+i+'" readOnly="readOnly"/>')+'\n\t\t\t\t\t<input type="hidden" class="s-inp combo-value"  value=""/>\n\t\t\t\t\t<span class="slide-icon '+n+'">\n\t\t\t\t\t</span>\n\t\t\t\t'}},{key:"handle",value:function(){var t=this;this.box.on("click",".combo-inp",function(e){e.stopPropagation();var i=$(this).parent();i.hasClass("active")?t.hideUp(i):t.showDown(i)})}},{key:"showDown",value:function(t){t.children(".combo-drop").show(),requestAnimationFrame(function(){t.addClass("active")})}},{key:"hideUp",value:function(t){t.removeClass("active"),t.children(".combo-drop").hide()}}]),t}();e.Unit=l,e.SCombobox=p,e.SModal=f,e.Calendar=s.Calendar,e.Tree=m,e.SComboTree=v,e.SInp=h,e.DropMenu=u,e.RippleBtn=d,e.Search=c},function(t,e,i){"use strict";i(3);var n=window.jsp_config,a=n.baseUrl,r=n.resourse?a:"./";hookAjax({onreadystatechange:function(t){if(t.responseXML)return window.open(r+"login.html","_top"),!0},onload:function(t){if(t.responseXML)return window.open(r+"login.html","_top"),!0}})},function(t,e){},function(t,e,i){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t){function e(n){if(i[n])return i[n].exports;var a=i[n]={exports:{},id:n,loaded:!1};return t[n].call(a.exports,a,a.exports,e),a.loaded=!0,a.exports}var i={};e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){i(1)(window)},function(t,e){t.exports=function(t){t.hookAjax=function(t){function e(e){return function(){var i=this.hasOwnProperty(e+"_")?this[e+"_"]:this.xhr[e],n=(t[e]||{}).getter;return n&&n(i,this)||i}}function i(e){return function(i){var n=this.xhr,a=this,r=t[e];if("function"==typeof r)n[e]=function(){t[e](a)||i.apply(n,arguments)};else{var s=(r||{}).setter;i=s&&s(i,a)||i;try{n[e]=i}catch(n){this[e+"_"]=i}}}}function a(e){return function(){var i=[].slice.call(arguments);if(!t[e]||!t[e].call(this,i,this.xhr))return this.xhr[e].apply(this.xhr,i)}}return window._ahrealxhr=window._ahrealxhr||XMLHttpRequest,XMLHttpRequest=function(){for(var t in this.xhr=new window._ahrealxhr,this.xhr){var r="";try{r=n(this.xhr[t])}catch(t){}"function"===r?this[t]=a(t):Object.defineProperty(this,t,{get:e(t),set:i(t)})}},window._ahrealxhr},t.unHookAjax=function(){window._ahrealxhr&&(XMLHttpRequest=window._ahrealxhr),window._ahrealxhr=void 0},t.default=t}}])},function(t,e){},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Calendar=void 0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}i(4);var r=function(){function t(e,i){a(this,t);var n=i.selTime,r=i.CurTime,s=i.updateShowSel,o=i.time,l=i.timeWatch,c=i.rotate;this.updateShowSel=s,this.time=o,this.rotate=c,this.CurTime=r,this.showTime=Object.assign({},n),this.selTime=n,this.viewBox=e,this.index=this.viewBox.index(),this.searsonFormatter=["一季度","二季度","三季度","四季度"],this.monFormatter=["一","二","三","四","五","六","七","八","九","十","十一","十二"],this.timeWatch=l,this.init(),this.handle()}return n(t,[{key:"init",value:function(){var t='<div class="s-calendar-time">'+this.renderTimeShow()+"</div>"+this.renderView();this.viewBox.html(t),this.calendarItems=this.viewBox.find(".calendar-item"),this.timeBox=this.viewBox.find(".s-calendar-time")}},{key:"getMonDays",value:function(t,e){return new Date(t,e,0).getDate()}},{key:"dayToWeek",value:function(t,e,i){return new Date(t,e-1,i).getDay()}},{key:"renderView",value:function(){var t=this.renderDays().join(""),e=this.renderMon().join(""),i=this.renderSeason().join(""),n=this.renderYear(this.showTime.year).join(""),a=new Array(4).fill(""),r=this.time?"has-watchTime":"";return a[this.rotate-1]="calendar-active",'\n\t\t\t\t\t<ul class="s-calendar-content">\n\t\t\t\t\t\t<li class="calendar-item '+a[0]+'">\n\t\t\t\t\t\t\t'+n+'\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li class="calendar-item '+a[1]+'">\n\t\t\t\t\t\t\t'+i+'\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li class="calendar-item '+a[2]+'">\n\t\t\t\t\t\t\t'+e+'\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li class="calendar-item '+a[3]+" "+r+'" >\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t'+t+"\n\t\t\t\t\t\t</li>\n\t\t\t\t\t</ul>\n\t\t\t   "}},{key:"renderTimeShow",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.rotate,e=this.showTime,i=e.year,n=e.mon,a=(e.searson,'\n\t\t\t\t\t\t\t<div class="calendar-control">\n\t\t\t\t\t\t\t\t<button class="s-btn day-btn" sign="'+t+'"><i class="fa fa-backward"></i></button>\n\t\t\t\t\t\t\t\t<button class="s-btn day-btn" sign="'+t+'"><i class="fa fa-forward"></i></button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t'),r="";switch(this.rotate){case 1:r="";break;case 2:case 3:r='<i class="fa fa-calendar">&nbsp;</i><span class="timeType" sign="1">'+i+"年</span>";break;case 4:r='<i class="fa fa-calendar">&nbsp;</i><span class="timeType" sign="1">'+i+'年</span><span>/</span><span class="timeType" sign="3">'+n+"月</span>"}return' <div class="time-box">\n\t\t\t\t\t\t\t\t\t'+r+"\n\t\t\t\t\t</div>\n\t\t\t\t\t"+((4===t||1===t)&&a||"")+" "}},{key:"renderDays",value:function(){var t=this,e=this.showTime,i=e.year,n=e.mon,a=this.getMonDays(i,n),r=this.dayToWeek(i,n,1),s=Math.ceil((a+r)/7),o="",l=new Array(s).fill("1").map(function(e,l){switch(l){case 0:var c=t.getMonDays(i,n-1),d=new Array(r).fill("1").map(function(e,i){var n=c-r+i+1;return t.dayComponent(n,"disabled")}),u=new Array(7-r).fill("1").map(function(e,i){var n=i+1;return t.dayComponent(n)});return'<ul class="data-group">'+d.concat(u).join("")+"</ul>";case s-1:o=7*l+1-r;var h=(a+r)%7||7,p=new Array(h).fill("1").map(function(e,i){var n=i+o;return t.dayComponent(n)}),f=new Array(7-h).fill("1").map(function(e,i){var n=i+1;return t.dayComponent(n,"disabled")});return'<ul class="data-group">'+p.concat(f).join("")+"</ul>";default:return o=7*l+1-r,'<ul class="data-group">'+new Array(7).fill("1").map(function(e,i){var n=i+o;return t.dayComponent(n)}).join("")+"</ul>"}});return this.time&&l.push(this.renderTimeBox()),['<ul class="week-group">\n\t\t\t\t\t\t\t<li>日</li><li>一</li><li>二</li><li>三</li><li>四</li><li>五</li><li>六</li>\n\t\t\t\t\t\t </ul>'].concat(function(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}(l))}},{key:"renderMon",value:function(){var t=this,e=this.showTime,i=e.year,n=(e.mon,this.CurTime.year===i),a=this.selTime.year===i;return new Array(4).fill("1").map(function(e,i){return'\t\n\t\t\t\t\t\t\t<ul class="mon-group">\n\t\t\t\t\t\t\t\t'+new Array(3).fill("1").map(function(e,r){var s=3*i+r+1;return'\n\t\t\t\t\t\t\t<li echo-text="'+s+'" class=" view-item '+(n&&t.CurTime.mon===s?"calendar-today":"")+" "+(a&&t.selTime.mon===s?"calendar-sel":"")+'" >\n\t\t\t\t\t\t\t\t<span class="mon-span">'+t.monFormatter[s-1]+"月</span>\n\t\t\t\t\t\t\t</li>\n\n\t\t\t\t\t\t\t"}).join("")+"\n\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t"})}},{key:"renderSeason",value:function(){var t=this,e=this.showTime,i=e.year,n=(e.searson,this.CurTime.year===i),a=this.selTime.year===i;return new Array(2).fill("1").map(function(e,i){var r=2*i+1,s=n&&r===t.CurTime.searson?"calendar-today":"",o=a&&t.selTime.searson===r?"calendar-sel":"",l=n&&r+1===t.CurTime.searson?"calendar-today":"",c=a&&t.selTime.searson===r+1?"calendar-sel":"";return'\n\t\t\t\t\t<ul class="searson-group">\n\t\t\t\t\t\t<li echo-text="'+r+'" class=" view-item '+s+" "+o+'">\n\t\t\t\t\t\t\t<span class="sea-span">'+t.searsonFormatter[r-1]+'</span>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li echo-text="'+(r+1)+'" class=" view-item '+l+" "+c+'" >\n\t\t\t\t\t\t\t<span class="sea-span">'+t.searsonFormatter[r]+"</span>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t</ul>\n\t\t\t\t\t"})}},{key:"renderYear",value:function(t){var e=this,i=t%10,n=t-(i=0===i?10:i)+1;this.lastYear=n+9;var a=new Array(9).fill("1").map(function(t,i){var a=n+i;return'\n\t\t\t\t\t<li echo-text="'+a+'" class=" view-item  '+(e.CurTime.year===a?"calendar-today":"")+" "+(e.selTime.year===a?"calendar-sel":"")+'">\n\t\t\t\t\t\t<span class="year-span">'+a+"</span>\n\t\t\t\t\t</li>\n\n\t\t\t\t\t"}),r=this.CurTime.year===this.lastYear?"calendar-today":"",s=this.selTime.year===this.lastYear?"calendar-sel":"",o='\n\t\t\t\t\t\t<div echo-text="'+this.lastYear+'" class="last-year view-item  '+r+" "+s+'">\n\t\t\t\t\t\t\t<span class="year-span">'+this.lastYear+"</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t ",l=new Array(3).fill("1").map(function(t,e){return'\n\t\t\t\t\t\t<ul class="year-group">\n\t\t\t\t\t\t\t'+a.splice(0,3).join("")+"\n\t\t\t\t\t\t</ul>\n\n\t\t\t\t\t"});return l.push(o),l}},{key:"dayComponent",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"abled",i=this.showTime,n=i.year,a=i.mon,r=this.selTime,s=r.year,o=r.mon,l=(r.searson,r.day);return'\n\t\t\t\t\t\t<li class="'+("abled"===e?" view-item ":"day-disabled")+" "+("abled"===e&&n===this.CurTime.year&&a===this.CurTime.mon&&this.CurTime.day===t?"calendar-today":"")+" "+("abled"===e&&n===s&&a===o&&t===l?"calendar-sel":"")+'"  echo-text="'+t+'">\n\t\t\t\t\t\t\t<span class="day-span">'+t+"</span>\n\t\t\t\t\t\t</li>\n\t\t\t\t"}},{key:"updateDays",value:function(t){var e=this.showTime,i=e.year,n=e.mon,a=void 0,r=void 0;switch(t){case 0:a=n-1==0?12:n-1,r=n-1==0?i-1:i;break;case 1:a=n+1==13?1:n+1,r=n+1==13?i+1:i}this.showTime.mon=a,this.showTime.searson=Math.ceil(a/3),this.showTime.year=r;var s=this.renderDays().join("");this.timeBox.html(this.renderTimeShow()),this.calendarItems.eq(3).html(s)}},{key:"updateYears",value:function(t){var e=0===t?this.lastYear-10:this.lastYear+1,i=this.renderYear(e).join("");this.calendarItems.eq(0).html(i)}},{key:"updateCalendar",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.rotate;this.timeBox.html(this.renderTimeShow(t));var e=this.showTime.year,i=t-1,n="";switch(t){case 1:n=this.renderYear(e).join("");break;case 2:n=this.renderSeason().join("");break;case 3:n=this.renderMon().join("");break;case 4:n=this.renderDays().join("")}this.calendarItems.eq(i).html(n),this.calendarItems.eq(i).addClass("calendar-active").siblings().removeClass("calendar-active")}},{key:"updateSel",value:function(t){t.closest(".calendar-item").find(".calendar-sel").removeClass("calendar-sel"),t.addClass("calendar-sel")}},{key:"renderTimeBox",value:function(){var t=this.timeWatch;return'<div class="m-time">\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<b>时间：&nbsp;</b>\n\t\t\t\t\t\t<input type="number" class="wacth-time" max="24" min="0" value="'+t[0]+'" echo-index="0" />\t\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<b>&nbsp;&nbsp;:&nbsp;</b>\n\t\t\t\t\t\t<input type="number" class="wacth-time" max="60" echo-index="1" min="0" value="'+t[1]+'" />\n\t\t\t\t\t</div>\n\t\t\t\t</div>'}},{key:"handle",value:function(){var t=this;this.viewBox.on("click",".day-btn",function(){var e=$(this).index();4==+$(this).attr("sign")?t.updateDays(e):t.updateYears(e)}),this.viewBox.on("blur",".wacth-time",function(){var e=$(this),i=+e.attr("echo-index");t.timeWatch[i]=e.val().padStart(2,"0"),t.updateShowSel()}),this.viewBox.on("click",".view-item",function(){var e=+$(this).attr("echo-text"),i=t.rotate,n=Array.from(t.calendarItems).findIndex(function(t){return t.classList.value.includes("calendar-active")});t.showTime[["year","searson","mon","day"][n]]=e;var a=t.showTime,r=a.year,s=a.searson,o=a.mon,l=a.day;t.selTime.year=r,t.selTime.searson=s,t.selTime.mon=o,t.selTime.day=l,t.updateShowSel(),i===n+1&&t.updateSel($(this))||t.updateCalendar()}),this.viewBox.on("click",".timeType",function(){var e=+$(this).attr("sign");t.updateCalendar(e)})}}]),t}(),s=function(){function t(e,i,n){a(this,t);var r=Object.assign({},{rotate:3,style:1,time:!1,hasInp:!0,callback:function(){}},n),s=r.rotate,o=r.style,l=r.time,c=r.hasInp,d=r.callback;this.rotate=s,this.style=o,this.time=l,this.hasInp=c,this.CurTime=this.getCurTime(),this.selTime=this.initSelTime(),this.typeChange=[{rotate:"年"},{rotate:"季"},{rotate:"月"},{rotate:"日"}],this.timeWatchArr=[[10,30],[12,50]],this.container=e,this.inp=i,this.callback=d,this.value="",this.init(),this.Handle()}return n(t,[{key:"changeStyle",value:function(t,e){this.style=t,this.selTime=this.initSelTime(),this.showSelBox.html(this.renderTimeStr().join("")),this.initViewsContent(),e&&this.setTime(e)}},{key:"init",value:function(){var t=this.initHead()+' <div class="calendar-container"> </div> ';this.container.html(t),this.calendarViewBox=this.container.children(".calendar-container"),this.showSelBox=this.container.find(".showSel-box"),this.frequemcy=this.container.find(".calendar-frequemcy"),this.rotateShow=this.container.find(".calendar-rotate"),this.initViewsContent()}},{key:"getCurTime",value:function(){var t=new Date,e=t.getFullYear(),i=t.getMonth()+1;return{year:e,mon:i,day:t.getDate(),searson:Math.ceil(i/3)}}},{key:"initHead",value:function(){var t=this,e=this.CurTime,i=(e.year,e.mon,e.searson,e.day,this.typeChange),n=i.map(function(e,i){var n=e.rotate;return'\n\t\t\t\t\t\t<li class="frequemcy-item '+(i===t.rotate-1?"frequemcy-active":"")+'">\n\t\t\t\t\t\t\t<span class="fa fa-calendar-plus-o">&nbsp;'+n+"</span>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t"});return'\n\t\t\t\t<div class="s-calendar-title">\n\t\t\t\t\t<div class="frequemcy-box">\n\t\t\t\t\t\t<button class="frequemcy-sel s-btn">\n\t\t\t\t\t\t\t<span class="fa fa-calendar-check-o"></span>\n\t\t\t\t\t\t\t<b class="calendar-rotate">'+i[this.rotate-1].rotate+'</b>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t\t<ul class="calendar-frequemcy">\n\t\t\t\t\t\t\t'+n.join("")+' \n\t\t\t\t\t\t</ul>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="showSel-box">\n\t\t\t\t\t\t'+this.renderTimeStr().join("")+"\n\t\t\t\t\t</div>\n\t\t\t\t\t"+(this.hasInp?'<div> <button class="s-btn calendar-opt">确定</button> <button class="s-btn calendar-opt">取消</button> </div>':"")+"\n\t\t\t\t\t\n\t\t\t\t</div>\n\n\t\t\t\t"}},{key:"initViewsContent",value:function(){var t=this,e=new Array(this.style).fill("").map(function(t){return'<div class="calendar-view"></div>'});this.calendarViewBox.html(e.join(""));var i=Array.from(this.calendarViewBox.children(".calendar-view")),n=(this.CurTime,this.CurTime),a=this.time,s=(this.timeWatchArr,{CurTime:n,rotate:this.rotate,time:a,updateShowSel:function(){t.updateShowSel()}});this.view_2&&(this.view_2.viewBox.unbind(),this.view_2=null),n.year,n.mon,n.searson,n.day,i.map(function(e,i){s.selTime=t.selTime[i],s.timeWatch=t.timeWatchArr[i],t["view_"+i]=new r($(e),s)}),this.upInp()}},{key:"renderTimeStr",value:function(){var t=this,e=" - ",i=[],n=new Array(this.style).fill("").map(function(n,a){var r=t.selTime[a],s=r.year,o=r.searson,l=r.mon,c=r.day,d=t.timeWatchArr[a];l=(l+"").padStart(2,"0"),c=(c+"").padStart(2,"0");var u="";switch(t.rotate){case 1:u="",i[a]=[s];break;case 2:u=""+(e+o),i[a]=[s,"S"+o];break;case 3:u=""+(e+l),i[a]=[s,l];break;case 4:u=""+(e+l)+(e+c),i[a]=[s,l,c]}return"\n\t\t\t\t\t\t"+(1===a?"<span >&nbsp;-&nbsp;&nbsp;</span>":"")+'<span class="sel-time-inp">'+(s+u+(t.time&&4===t.rotate&&"&nbsp;&nbsp;"+d.join(" : ")||""))+"</span>\n\n\t\t\t\t\t\t"});return this.value=i,n}},{key:"initSelTime",value:function(){var t=this.CurTime,e=t.year,i=t.mon,n=t.searson,a=t.day,r=this.rotate;return new Array(this.style).fill("").map(function(t,s){switch(r){case 4:return{year:e,searson:n,mon:i+s,day:a+s};case 2:return{year:e,searson:n+s,mon:i,day:a};case 3:return{year:e,searson:n,mon:i+s,day:a};case 1:return{year:e+s,searson:n,mon:i,day:a}}})}},{key:"updateShowSel",value:function(t){var e=this,i=new Array(this.style).fill("").map(function(t,i){return e["view_"+i].selTime});this.selTime=i,this.showSelBox.html(this.renderTimeStr().join(""))}},{key:"updateRotate",value:function(){var t=this.rotate-1;this.rotateShow.html(this.typeChange[t].rotate),this.frequemcy.children().eq(t).addClass("frequemcy-active").siblings().removeClass("frequemcy-active")}},{key:"upInp",value:function(){var t=this;if(this.hasInp){var e=this.value.map(function(e,i){var n=t.time&&4===t.rotate&&"  "+t.timeWatchArr[i].join(" : ")||"";return e.join(" - ")+n});this.inp.val(e.join(" 至 "))}}},{key:"setTime",value:function(t){var e=this;if(Array.isArray(t)){var i=t[0]+"";4===i.length?(this.rotate=1,new Array(this.style).fill("").map(function(i,n){e.selTime[n].year=+t[n].substr(0,4);var a=e["view_"+n];a.rotate=e.rotate,a.showTime=Object.assign({},e.selTime[n]),a.updateCalendar()})):i.includes("S")?(this.rotate=2,new Array(this.style).fill("").map(function(i,n){e.selTime[n].year=+t[n].substr(0,4),e.selTime[n].searson=+t[n].substr(5,1);var a=e["view_"+n];a.rotate=e.rotate,a.showTime=Object.assign({},e.selTime[n]),a.updateCalendar()})):6===i.length?(this.rotate=3,new Array(this.style).fill("").map(function(i,n){e.selTime[n].year=+t[n].substr(0,4),e.selTime[n].mon=parseInt(t[n].substr(4,2));var a=e["view_"+n];a.rotate=e.rotate,a.showTime=Object.assign({},e.selTime[n]),a.updateCalendar()})):(this.rotate=4,new Array(this.style).fill("").map(function(i,n){e.selTime[n].year=+t[n].substr(0,4),e.selTime[n].mon=parseInt(t[n].substr(4,2)),e.selTime[n].day=parseInt(t[n].substr(6,2));var a=e["view_"+n];a.rotate=e.rotate,a.showTime=Object.assign({},e.selTime[n]),e.time&&(e.timeWatchArr[n]=t[n].split("@")[1].split(":"),a.timeWatch=e.timeWatchArr[n]),a.updateCalendar()})),this.updateShowSel(),this.upInp(),this.updateRotate()}}},{key:"Handle",value:function(){var t=this,e=this.hasInp;this.container.on("click",".frequemcy-item",function(){var e=$(this).index();t.frequemcy.slideToggle("fast",function(){t.rotate=e+1,t.updateRotate(),t.updateShowSel(),new Array(t.style).fill("").map(function(e,i){var n=t["view_"+i];n.rotate=t.rotate,n.updateCalendar()})})}),this.container.on("click",function(t){t.stopPropagation()}),e&&this.inp.click(function(e){e.stopPropagation(),t.container.is(":visible")?t.container.hide():t.container.show()}),this.container.on("click",".frequemcy-sel",function(){t.frequemcy.slideToggle()}),this.container.on("click",".calendar-opt",function(){if(0===$(this).index()){if(2===t.style){var e=t.value[0].join("/");e=2===t.rotate&&e.replace("S","")||e,e=new Date(e).getTime();var i=t.value[1].join("/");if(i=2===t.rotate&&i.replace("S","")||i,(i=new Date(i).getTime())<e)return void alert("结束时间要大于开始时间！")}t.callback(),t.upInp()}t.container.hide()})}}]),t}();e.Calendar=s},function(t,e){},function(t,e){},function(t,e){},,,,function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();i(1);var a=window.jsp_config.baseUrl,r=a+"main/",s=a+"chart/",o=a+"layout/",l=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return n(t,[{key:"getAllLayoutPar",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";return Promise.resolve($.post(o+"getAllLayoutPar",{keyword:t}))}},{key:"checkName",value:function(t){return Promise.resolve($.post(o+"checkName",t))}},{key:"copyLayout",value:function(t){return Promise.resolve($.post(o+"copyLayout",t))}},{key:"orgtree",value:function(){return Promise.resolve($.get(r+"orgtree"))}},{key:"kpitree",value:function(){return Promise.resolve($.get(r+"kpitree"))}},{key:"dimtree",value:function(){return Promise.resolve($.get(r+"dimtree"))}},{key:"GroupKpiByDim",value:function(t){return Promise.resolve($.ajax({url:r+"GroupKpiByDim",data:JSON.stringify(t),contentType:"application/json",type:"post"}))}},{key:"getTableInfo",value:function(t){return Promise.resolve($.ajax({url:s+"getTableInfo",data:JSON.stringify(t),contentType:"application/json",type:"post"}))}},{key:"upload",value:function(t){return Promise.resolve($.ajax({url:a+"/Expo/upload",data:JSON.stringify(t),contentType:"application/json",type:"post"}))}},{key:"addAssembly",value:function(t){return Promise.resolve($.ajax({url:o+"addAssembly",type:"post",cache:!1,data:t,processData:!1,contentType:!1}))}},{key:"getGraphInfo",value:function(t){return Promise.resolve($.ajax({url:s+"getGraphInfo",data:JSON.stringify(t),contentType:"application/json",type:"post"}))}},{key:"saveTableInfo",value:function(t){return Promise.resolve($.ajax({url:s+"saveTableInfo",data:JSON.stringify(t),contentType:"application/json",type:"post"}))}},{key:"saveGraphInfo",value:function(t){return Promise.resolve($.ajax({url:s+"saveGraphInfo ",data:JSON.stringify(t),contentType:"application/json",type:"post"}))}},{key:"saveLayout",value:function(t){return Promise.resolve($.ajax({url:o+"saveLayout",type:"post",cache:!1,data:t,processData:!1,contentType:!1}))}},{key:"showLayoutModel",value:function(t){return Promise.resolve($.post(o+"showLayoutModel",{layout_id:t}))}},{key:"deleteChart",value:function(t){return console.log("删掉了...",t),Promise.resolve($.post(s+"deleteChart",{CHART_ID:t}))}}]),t}());e.api=l},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TimeView=e.STable=e.Border=e.View=void 0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(22),r=i(21),s=i(20),o=i(18),l=i(16),c=function(){function t(e,i,n){var a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"1";!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this);var r=i.id,s=i.type,o=i.index,l=i.viewTitle,c=i.size,d=i.borderType;this.container=e,this.viewType=s,this.borderType=d,this.viewTitle=l,this.id=r,this.index=o,this.status=a,this.size=c,this.init(n)}return n(t,[{key:"init",value:function(t){var e=this.container.children(".view-content");"0"!==this.borderType&&this.initBorder(this.container.children(".bgSvg")),e.html(this.renderContent());var i=e.children(".view_main");this[{table:"initTable",chart:"initChart",timeReal:"initRealTime",editView:"initEditView"}[this.viewType]](i,t)}},{key:"initChart",value:function(t,e){var i=this.borderType,n=this.size;this.chart=new r.Chart(t[0],{border:i,size:n},e)}},{key:"initTable",value:function(t,e){var i=this.borderType,n=this.size;this.table=new s.STable(t,{border:i,size:n},e)}},{key:"initRealTime",value:function(t,e){var i=this.borderType,n=this.size;this.timeReal=new o.TimeView(t,{border:i,size:n},e)}},{key:"initEditView",value:function(t,e){var i=this.borderType;this.editView=new l.EditView(t,{border:i},e)}},{key:"initBorder",value:function(t){var e=this.viewTitle,i=this.id,n=this.borderType,r=this.size;this.border=new a.Border(t,{id:i,title:e,size:r,borderType:n})}},{key:"renderViewOpt1",value:function(){var t=["table","chart"].includes(this.viewType)?'<span class="fa fa-file-excel-o view-btn" sign="excel" title="导出excel"></span><span class="fa fa-filter view-btn" sign="filter" title="筛选"></span><span class="fa fa-refresh view-btn" sign="refresh" title="刷新"></span>':"",e="chart"===this.viewType?'<span class="fa fa-file-image-o view-btn" sign="image" title="导出图片"></span>':"";return this.viewType,'<div class="view-optBox " >\n\t        \t\t<div class="btn-handle">\n\t\t\t\t\t\t<span class="fa fa-bars" ></span>\n\t\t\t\t\t</div>\n\t        \t\t<div class="view-btns" echo-id="'+this.id+'" echo-index="'+this.index+'">\n\t\t\t\t\t\t<span class="fa fa-expand view-btn" sign="expand" title="最大化"></span>\n\t\t\t\t\t\t'+e+"\n\t\t\t\t\t\t"+t+"\n\t\t\t\t\t</div>\n\t        \t</div>"}},{key:"renderViewOpt2",value:function(){return["table","chart"].includes(this.viewType),'<div class="view-optBox " >\n\t        \t\t<div class="btn-handle">\n\t\t\t\t\t\t<span class="fa fa-bars" ></span>\n\t\t\t\t\t</div>\n\t        \t\t<div class="view-btns" echo-id="'+this.id+'" echo-index="'+this.index+'">\n\t\t\t\t\t\t<span class="fa fa-trash view-btn" sign="remove" title="删除"></span>\n\t\t\t\t\t\t<span class="fa fa-edit view-btn" sign="set" title="设置"></span>\n\t\t\t\t\t</div>\n\t\t\t\t\t\n\t        \t</div>'}},{key:"renderContent",value:function(){return(1==this.status&&this.renderViewOpt1()||this.renderViewOpt2())+'<div class="view_main  '+this.viewType+'_main"></div>'}}]),t}();e.View=c,e.Border=a.Border,e.STable=s.STable,e.TimeView=o.TimeView},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();i(1);var a=window.jsp_config.baseUrl,r=a+"layout/",s=a+"chart/",o=a+"Expo/",l=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return n(t,[{key:"showLayoutModel",value:function(t){return Promise.resolve($.post(r+"showLayoutModel",{layout_id:t}))}},{key:"getGraphData",value:function(t){return Promise.resolve($.post(s+"getGraphData",{chart_id:t}))}},{key:"getExeclld",value:function(t){return Promise.resolve($.ajax({url:o+"getExeclId",type:"post",contentType:"application/json",data:JSON.stringify(t)}))}},{key:"getTableData",value:function(t){return Promise.resolve($.post(s+"getTableData",{chartId:t}))}},{key:"getTableInfo",value:function(t){return Promise.resolve($.ajax({url:s+"getTableInfo",data:JSON.stringify(t),contentType:"application/json",type:"post"}))}},{key:"getGraphInfo",value:function(t){return Promise.resolve($.ajax({url:s+"getGraphInfo",data:JSON.stringify(t),contentType:"application/json",type:"post"}))}},{key:"getAssembly",value:function(t){return Promise.resolve($.get(r+"getAssembly",{assembly_id:t}))}}]),t}());e.api=l},function(t,e){},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=function(){function t(e,i,n){!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.borderType=i.borderType,this.box=e,this.init(n)}return n(t,[{key:"init",value:function(t){this.box.html(t)}}]),t}();e.EditView=a},function(t,e){},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TimeView=void 0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();function a(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}i(17);var r=function(){function t(e,i,n){!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this);var a=i.border,r=i.size;this.border=a,this.size=r,this.numCount=6,this.box=e,this.oldArr=Array.from({length:n.data.length-1},function(t){return"000000"}),this.init(n)}return n(t,[{key:"init",value:function(t){var e=this,i=(t.tabInfo,t.tabInfo.tab_style),n=[],a=t.data.slice(1).map(function(t,a){return e.getItem(i,t,a,n)});this.box.html(a.join("")),this.oldArr=n}},{key:"getRandom",value:function(){return Math.floor(791*Math.random()+10)}},{key:"closeReload",value:function(){clearInterval(this.timer),this.timer=null}},{key:"getItem",value:function(t,e,i,n){var r=e[0],s=e.slice(1).reduce(function(t,e){return t+~~e},0),o=this.numCount,l=(s+"").padStart(o,"0");n.push(l);var c=[].concat(a(l)),d=this.oldArr[i],u=[].concat(a(d));return'<div class="timeItem timeStyle'+t+'" style="width:'+(1/(t*this.size[0])*100-2)+'%">\n\t\t\t\t\t\t\t<p class="real-zb">'+r+'</p>\n\t\t\t\t\t\t\t<ul class="reak-dataBox">\n\t\t\t\t\t\t\t\t'+this.renderData(c,u).join("")+"\n\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t </div>"}},{key:"renderData",value:function(t,e,i){var n=t.length;return t.map(function(t,i){var a=+e[i],r=a<t,s=r?t:a;return'<li class="item-data " >\n\t\t\t\t\t\t<div class="'+(t==a?"":r?"real-down":"real-up")+'" style="animation-duration:'+.5*(n-i)+'s"><p>'+s+"</p><p>"+(a+ +t-s)+"</p></div>\n\t\t\t\t\t</li>"})}}]),t}();e.TimeView=r},function(t,e){},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.STable=void 0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();i(19);var a=function(){function t(e,i,n){!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this);var a=i.border,r=i.size,s=JSON.parse(JSON.stringify(n));this.border=a,this.size=r,this.container=e,this.init(s)}return n(t,[{key:"init",value:function(t){var e=t.tabInfo,i=e.chartName,n=e.row_wd,a=e.col_wd,r=e.total,s=e.tab_style,o=t.data;this.title=i,this.config={row_wd:n,col_wd:a,total:r,tab_style:s};var l=this.renderTableHead(o),c=this.renderTableBody(o),d=this.container.height(),u=this.border,h="0"===u&&i?30:0,p="0"===u?"":50,f='\n\t\t\t\t\t\t<div  class="s-tableBox fix-tab '+("0"!==s?"border-box":"")+'" style="'+("0"===u?"":"padding:35px 20px 30px;")+'">\n\t\t\t\t\t\t\t\t'+("0"===u&&i?'<p class="s-table-title">'+i+"</p>":"")+'\n\t\t\t\t\t\t\t\t<div class="tab-head">\n\t\t\t\t\t\t\t\t\t<table class="tab-list ">\n\t\t\t\t\t\t\t\t\t\t<thead>\n\t\t\t\t\t\t\t\t\t\t    '+l.join("")+'   \n\t\t\t\t\t\t\t\t\t    </thead>\n\t\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t<div class="table-body-wrap ">\n\t\t\t\t\t\t\t\t\t   <table  border="'+s+'" class="tab-list table-body" frame="void">\n\t\t\t\t\t\t\t\t\t\t\t'+c.join("")+"\n\n\t\t\t\t\t\t\t\t\t   </table>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t";this.container.html(f);var m=this.container.find(".table-body-wrap"),v=Math.floor(d-this.container.find(".tab-head").height()-h-p);v-m.children("table").height()<0&&(m.css("height",v),this.container.find(".gutter").show())}},{key:"getRandom",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:500;return Math.floor(Math.random()*(t-100+1)+100)}},{key:"renderTableHead",value:function(t){var e=this,i=this.config,n=i.row_wd,a=i.col_wd,r=i.total,s=["","时间","科室","指标","维度值"],o=n.length;return t.slice(0,o).map(function(t,i){var l=e.colspanCount(t,r),c=l.headData,d=l.colspanCount,u=c.reduce(function(t,e,n){var a="";return i<o-1&&(n+1)%d==0?a='<th colspan="'+d+'">'+e+"</th>":i==o-1&&(a="<th>"+e+"</th>"),t.push(a),t},[]);if(0===i){var h=a.map(function(t){return s[+t]});u.unshift('<th rowspan="'+n.length+'" width="'+(120*a.length+a.length-1)+'">'+h.join(" / ")+"</th>"),["1","3"].includes(r)&&(u[u.length]='<th rowspan="'+o+'">合计</th>'),u.push('<th class="gutter" rowspan="'+o+'"></th>')}return"<tr>"+u.join("")+"</tr>"})}},{key:"renderRow",value:function(t,e,i){return t.reduce(function(t,n,a){if(a<i.length){var r=i[a];(e+1)%r!=1&&1!==r||t.push('<td rowspan="'+r+'" width="120">'+n+"</td>")}else t.push("<td>"+n+"</td>");return t},[])}},{key:"renderTableBody",value:function(t){var e=this,i=this.config,n=i.row_wd,a=i.col_wd,r=i.total,s=i.tab_style,o=t.slice(n.length),l=this.rowspanCount(o),c=["2","3"].includes(r)&&o.pop().splice(a.length)||null,d=0,u=o.map(function(t,i){return i%l[0]==0&&d++,'<tr class="'+("0"===s?d%2==0?"tr-bg1":"tr-bg2":"")+'">'+e.renderRow(t,i,l).join("")+"</tr>"});if(c){var h=c&&c.map(function(t){return"<td>"+t+"</td>"});u.push('<tr class="'+("0"===s?"foot-bg":"")+'"><td colspan="'+a.length+'">合计</td>'+h.join("")+"</tr>")}return u}},{key:"rowspanCount",value:function(t){return this.config.col_wd.map(function(e,i){var n=t[0][i],a=t.findIndex(function(t,e){return t[i]!=n});return-1===a?1:a})}},{key:"colspanCount",value:function(t,e){var i=this.config,n=(i.row_wd,i.col_wd);t.splice(0,n.length),["1","3"].includes(e)&&t.pop();var a=t.findIndex(function(e){return e!==t[0]});return{headData:t,colspanCount:a}}}]),t}();e.STable=a},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Chart=void 0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();i(14);var a=function(){function t(e,i,n){!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this);var a=i.border,r=i.size;this.border=a,this.size=r,this.type="",this.Box=e,this.init(n)}return n(t,[{key:"init",value:function(t){var e=this.border,i=t.graphInfo,n=i.chartType,a=i.chartName,r=i.contrastDim,s=i.rowDim,o=t.data;this.type=n;var l=this[{3:"tabConfig",4:"lineConfig",5:"pieConfig",6:"radarConfig",7:"scatterConfig"}[this.type]](o);l.Dim={contrastDim:r,rowDim:s},"0"===e&&(l.title={text:a,left:"center",textStyle:{color:"white",fontSize:14}},l.backgroundColor="#4490c175");var c=echarts.init(this.Box);c.setOption(l),$(window).on("resize",function(){c.resize()})}},{key:"pieConfig",value:function(t){var e=t[0],i=e.rowData,n=e.legend,a=e.rowDataUnit,r=e.roseType,s=i.map(function(e,i){var n="--"!=e&&e||0,s=a[i];return{name:t[0].rowDimName[i],value:n,unit:s,selected:r%2!=0}}),o=["#c487ee","#05acff","#deb140","#8171ff","#05ffff","#49dff0","#6f81da","#00ffb4"],l=["#1296FB","#09c1ff","#0088CC","#05fcfb","#ffa597","#00c4a5","#05ffff","#ff6584"],c=o.length-1,d=s.map(function(t,e){var i=e%c,n={normal:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:o[i]},{offset:1,color:l[i]}],globalCoord:!0}}};return Object.assign({},t,{itemStyle:n})}),u=this.getLegendPosition(n),h=Object.assign(u.legend,{textStyle:{color:"#f2f2f2",fontSize:12},icon:"circle",data:s});return{tooltip:{show:!0,trigger:"item",confine:!0},roseType:r%2==0,legend:h,series:[{radius:r<3&&["10%","60%"]||["30%","60%"],center:u.center,type:"pie",label:{show:!0,position:"outside",color:"#ddd",formatter:function(t){return t.name+"\n{white|占比:"+t.percent+"%}"},rich:{white:{color:"#ddd",align:"center",padding:[3,0]}}},labelLine:{show:!0,smooth:!0,color:"#ffff"},name:"",data:d,tooltip:{formatter:function(t){var e=t.name,i=t.value,n=(t.percent,t.data.unit);return"<span>"+e+"："+i+"</span>&nbsp;"+("--"!==n&&n||"")}}}]}}},{key:"getRandom",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:500;return Math.floor(Math.random()*(t-80+1)+80)}},{key:"getLegendPosition",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1],i=this.border,n="3"===i?"12%":"8%",a=e?16:0,r="3"===i?4:3,s="3"===i?8:6;switch(t){case"1":return{legend:{top:n,left:10,orient:"horizontal"},grid:{top:s+20+"%",left:a+10+"%",right:"10%",bottom:"18%",containLabel:!1},center:["50%",r+55+"%"]};case"2":return{legend:{bottom:16,left:10,orient:"horizontal"},grid:{top:s+12+"%",left:a+10+"%",right:"10%",bottom:"32%",containLabel:!1},center:["50%",r+45+"%"]};case"3":return{legend:{top:n,left:4,orient:"vertical"},grid:{left:a+30+"%",top:s+12+"%",right:"10%",bottom:"18%",containLabel:!1},center:["55%",r+50+"%"]};case"4":return{legend:{top:n,right:4,orient:"vertical"},grid:{top:s+14+"%",right:"26%",left:a+10+"%",bottom:"18%",containLabel:!1},center:["45%",r+50+"%"]};case"5":return{legend:{show:!1},grid:{left:a+10+"%",right:"10%",top:s+12+"%",bottom:"18%",containLabel:!1},center:["45%",r+50+"%"]}}}},{key:"lineConfig",value:function(t){var e=["#1296FB","#8FD6FA","#0088CC","#06B76A","#CBC450","#FD8D1D"],i=t[0],n=i.rowDimName,a=i.landscape,r=i.legend,s=i.threeD,o=i.stack,l=i.lineType,c=s.split(","),d=n.map(function(t){return{value:t,textStyle:{color:"white"}}}),u=[],h=t.map(function(t,i){var n=t.contrastDimName,r=t.rowData;t.rowDataUnit,u[i]=n;var s="1"===l&&"1"===a&&{normal:{color:new echarts.graphic.LinearGradient(0,0,0,1,[{offset:0,color:e[i]},{offset:.8,color:"rgba(255,255,255,0)"}],!1),shadowBlur:10,opacity:.3}}||null,c=r.map(function(t){return"--"!=t&&t||null});return{name:n,type:"1"===l?"line":"bar",areaStyle:s,smooth:!0,showSymbol:!0,symbol:"circle",symbolSize:8,barWidth:20,stack:"1"===o?"stack":null,data:c}}),p="2"===l&&"1"===a,f=this.getLegendPosition(r,p),m=Object.assign(f.legend,{textStyle:{fontSize:12,color:"white"},data:u}),v=Object.assign(f.grid,{}),b={type:"category",data:d,boundaryGap:"1"!==l,axisLine:{show:Boolean(+c[0]),lineStyle:{color:"#fff"}},axisTick:{show:Boolean(+c[0])},axisLabel:{textStyle:{fontSize:12}}},y={type:"value",axisLine:{show:Boolean(+c[1]),lineStyle:{color:"#fff"}},axisTick:{show:Boolean(+c[1])},splitLine:{show:Boolean(+c[1])},axisLabel:{show:Boolean(+c[1]),textStyle:{fontSize:12}}};return{color:["#1a9bfc","#99da69","#01babc","#5c8d89"],tooltip:{trigger:"axis",confine:!0,axisPointer:{lineStyle:{color:"#ddd"}},backgroundColor:"rgba(255,255,255,1)",padding:[5,10],textStyle:{color:"#7588E4"},extraCssText:"box-shadow: 0 0 5px rgba(0,0,0,0.3)"},grid:v,legend:m,xAxis:p&&y||b,yAxis:p&&b||y,series:h}}},{key:"scatterConfig",value:function(t){console.log(t);var e=t[0],i=e.rowDimName,n=e.landscape,a=e.legend,r=e.threeD,s=[],o=t.map(function(t,e){var i=t.contrastDimName,a=t.rowData;return{name:s[e]=i,type:"scatter",smooth:!0,showSymbol:!0,symbol:"circle",symbolSize:function(t){return"1"===n&&Math.sqrt(t)||8},data:a.map(function(t){return"--"!=t&&t||null})}}),l=r.split(","),c=i.map(function(t){return{value:t,textStyle:{color:"white"}}}),d=this.getLegendPosition(a);return{color:["#1296FB","#8FD6FA","#0088CC","#06B76A","#CBC450","#FD8D1D"],legend:Object.assign(d.legend,{textStyle:{fontSize:12,color:"white"},data:s}),grid:Object.assign(d.grid,{}),tooltip:{padding:10,confine:!0,backgroundColor:"#222",borderColor:"#777",borderWidth:1,formatter:function(t){var e=t.value;return'<div style="border-bottom: 1px solid rgba(255,255,255,.3); font-size: 14px;padding-bottom: 7px;">'+t.seriesName+": "+e+"</div>"}},xAxis:{type:"category",data:c,axisLine:{show:Boolean(+l[0]),lineStyle:{color:"#fff"}},axisTick:{show:Boolean(+l[0])},axisLabel:{textStyle:{fontSize:12}}},yAxis:{type:"value",axisLine:{show:Boolean(+l[1]),lineStyle:{color:"#fff"}},axisTick:{show:Boolean(+l[1])},splitLine:{show:Boolean(+l[1]),lineStyle:{type:"dashed",opacity:.6}},axisLabel:{show:Boolean(+l[1]),textStyle:{fontSize:12}}},series:o}}},{key:"radarConfig",value:function(t){var e,i,n=t[0],a=n.rowDimName,r=n.legend,s=n.area,o=a.map(function(t){return{text:t,max:function(t){return 1.5*t.max}}}),l=[],c=t.map(function(t,e){var i=t.rowData,n=t.contrastDimName;return l[e]=n,{value:i.map(function(t){return"--"!=t&&t||""}),name:n}}),d=this.getLegendPosition(r);return{color:["#1296FB","#8FD6FA","#0088CC","#06B76A","#CBC450","#FD8D1D"],tooltip:{trigger:"axis",confine:!0},legend:Object.assign(d.legend,{textStyle:{color:"#f2f2f2",fontSize:12},itemWidth:12,itemHeight:12,data:l}),radar:[{indicator:o,center:d.center,radius:"60%",shape:"1"===s?"polygon":"circle",name:{textStyle:{color:"white",fontSize:12}},nameGap:10,splitLine:{lineStyle:{color:"#0b5263",opacity:.5,width:2}},splitArea:{areaStyle:(e={color:"#E9E6C9",opacity:1,shadowBlur:45,shadowColor:"rgba(0,0,0,.5)",shadowOffsetX:0,shadowOffsetY:15},i="opacity",.5,i in e?Object.defineProperty(e,i,{value:.5,enumerable:!0,configurable:!0,writable:!0}):e[i]=.5,e)},axisLine:{show:!0,lineStyle:{color:"#189cbb",type:"dashed"}}}],series:[{type:"radar",tooltip:{trigger:"item"},data:c,symbolSize:2,itemStyle:{normal:{borderColor:"#ffc72b",borderWidth:2}},lineStyle:{normal:{color:"#fff",width:2}},areaStyle:{normal:{shadowBlur:13,shadowColor:"rgba(127,95,132,.3)",shadowOffsetX:0,shadowOffsetY:10,opacity:.6}}}]}}}]),t}();e.Chart=a},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=function(){function t(e,i){!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this);var n=i.id,a=i.title,r=i.size,s=i.borderType;this.box=e,this.w=r[0],this.h=r[1],this.id=n,this.title=a,this.type=+s,this.init()}return n(t,[{key:"init",value:function(){this.box.html(this.render())}},{key:"getPoint1",value:function(t){var e=t.rotate,i=t.position,n="top"===i||"bottom"===i?950:500,a=950===n,r=a?250:115,s=("bottom"===i?235:"top"===i&&225)||87.5,o=a?0:25,l=("bottom"===i?12.5:"top"===i&&30)||12.5,c=[];c[0]=25,c[5]=e*n-25-o,c[1]=s+25+(e-1)*r,c[2]=c[1]+l,c[4]=e*n-c[1]-o,c[3]=c[4]-l;var d=a?0:1,u=1-d,h=[],p="top"===i||"left"===i?0:"bottom"===i&&500*this.h-25||950*this.w;h[u]=p;var f=("top"===i?50:"left"===i&&25)||"bottom"===i&&500*this.h||950*this.w-25;return c.map(function(t,e){return h[d]=t,h[u]=3==e||2==e?f:p,h.join(" ")})}},{key:"getPoint2",value:function(t){var e=t.rotate,i=t.position,n="top"===i||"bottom"===i?950:500,a=[];if("top"===i)a[0]=80,a[3]=n*e-30,a[2]=a[3]-150-100*(e-1),a[1]=a[2]-60;else{var r=("left"===i?80:"right"===i&&100)||50;a[0]=r,a[1]=n*e-50}var s=950===n?0:1,o=1-s,l=[],c="top"===i||"left"===i?0:"bottom"===i&&500*this.h||950*this.w;return l[o]=c,a.map(function(t,e){return l[s]=t,2==e&&(l[o]=60),l.join(" ")})}},{key:"getPath",value:function(){var t=this,e=["","getPoint1","getPoint2"][this.type];return["top","right","bottom","left"].map(function(i,n){var a=n%2==0,r=t[e]({position:i,rotate:a&&t.w||t.h});return 1<n&&r.reverse().join(" , ")||r.join(" , ")})}},{key:"render",value:function(){return this[["","renderBoder1","renderBoder2","renderBoder3"][this.type]]()}},{key:"renderBoder1",value:function(){var t=this.id;return'\n\t\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg"   xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 '+(950*this.w+20)+" "+(500*this.h+20)+'" preserveAspectRatio="none">\n\t\t\t\t\t\t\t<defs >\n\t\t\t\t\t\t\t   <desc>边框形状的多边形</desc>\n\n\t\t\t\t\t\t\t  \t<filter width="100%" height="100%" x="0" y="0" id="blur'+t+'" filterUnits="objectBoundingBox">\n\t\t\t\t\t\t\t\t  \t<feGaussianBlur stdDeviation="15" in="SourceGraphic" />\n\t\t\t\t\t\t\t\t</filter>\n\t\t\t\t\t    \t\t<filter x="0" y="0" width="100%" height="100%" filterUnits="objectBoundingBox" id="filter'+t+'">\n\t\t\t                        <feOffset dx="0" dy="-10" in="SourceAlpha" result="shadowOffsetOuter1"></feOffset>\n\t\t\t                        <feGaussianBlur stdDeviation="15" in="shadowOffsetOuter1" result="shadowBlurOuter1"></feGaussianBlur>\n\t\t\t                        <feColorMatrix values="0 0 0 0 0.266666667   0 0 0 0 0.694117647   0 0 0 0 0.607843137  0 0 0 0.7 0" in="shadowBlurOuter1" type="matrix" result="shadowMatrixOuter1"></feColorMatrix>\n\t\t\t                        <feMerge>\n\t\t\t                            <feMergeNode in="shadowMatrixOuter1"></feMergeNode>\n\t\t\t                            <feMergeNode in="SourceGraphic"></feMergeNode>\n\t\t\t                        </feMerge>\n                    \t\t\t</filter>\t\t\n\t\t\t\t\t\t\t\t<desc>四个角的形状</desc>\n\n\t\t\t\t\t\t\t\t<g id="angle'+t+'" class="angle" >\n\t\t\t\t\t\t\t\t\t<path  d="M26.48 4.94L68.35 4.94L70.56 9.46L92.41 9.46L87.78 0.01L68.35 0.01L68.35 0.01L24.67 0.01L24.67 0.01L24.67 0.01L0 27.82L0 27.82L0 74.38L0 77.07L0 98.99L8.38 104.2L8.38 79.59L4.35 77.07L4.37 77.07L4.37 29.87L4.37 29.87L26.48 4.94Z"  />\n\t\t\t\t\t\t\t\t\t<path d="M25.21 27.87L25.21 8.18L7.75 27.87L7.75 27.87L25.21 27.87Z" id="a4eOZ2LBP"/>\n\t\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t\t\t<desc>小菱形</desc>\n\t\t\t\t\t\t\t\t<pattern id="pattern'+t+'" x="0" y="0" width="10" height="10"\n\t\t\t\t\t\t\t           patternUnits="userSpaceOnUse" >\n\t\t\t\t\t\t\t     \t<rect x="2.5" y="0" width="5" height="10" fill="#3B9CCB"/>\n\t\t\t\t\t\t\t    </pattern>\n\t\t\t\t\t\t\t    <g id="rhombic'+t+'" class="rhombic" fill="#3B9CCB">\n\t\t\t\t\t\t\t   \t\t<desc>大菱形左</desc>\n\t\t\t\t\t\t\t    \t<rect x="105" y="0" width="30" height="10"  />\n\t\t\t\t\t\t\t\t\t<rect x="140" y="0" width="'+(60+100*(this.w-1))+'" height="10" fill="url(#pattern'+t+')" />\n\t\t\t\t\t\t\t\t\t<desc>大菱形右</desc>\n\t\t\t\t\t\t\t\t\t<rect x="'+(205+100*(this.w-1))+'" y="0" width="30" height="10" />\n\t\t\t\t\t\t\t    </g>\n\t\t\t\t\t\t\t</defs>\n\n\t\t\t\t\t\t\t<g transform="translate(10 10)" >\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t<g style="opacity:0.3;" >\n\t\t\t\t\t\t\t\t\t<polygon id="shape"  fill="#d2ebf0" class="shade" stroke="" points="'+this.getPath().join(" , ")+'"  />\n\t\t\t\t\t\t\t\t</g>\n\n\t\t\t\t\t\t\t\t\t<polygon   fill="#5c90b275" filter="url(#blur'+t+')" stroke-width="4" stroke="#d2ebf0" points="'+this.getPath().join(" , ")+'"  />\n\n\t\t\t\t\t\t\t\t<g fill="#95d3df">\n\t\t\t\t\t\t\t\t\t<use xlink:href="#angle'+t+'"/>\n\t\t\t\t\t\t\t\t\t<use xlink:href="#angle'+t+'" transform="scale(-1,1) translate(-'+950*this.w+')" ></use>\n\t\t\t\t\t\t\t\t\t<use xlink:href="#angle'+t+'" transform="scale(1,-1) translate(0 -'+(500*this.h-25)+')"/>\n\t\t\t\t\t\t\t\t\t<use xlink:href="#angle'+t+'" transform="scale(-1,-1) translate(-'+950*this.w+" -"+(500*this.h-25)+')"/>\n\t\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t\t\t<g \tfill="#95d3df" >\n\t\t\t\t\t\t\t\t   <use xlink:href="#rhombic'+t+'" transform="skewX(30)" />\n\t\t\t\t\t\t\t\t   <use xlink:href="#rhombic'+t+'" transform="translate('+(950*this.w-210-130-100*(this.w-1))+' 0) skewX(-30)" />\n\t\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t<text x="'+950*this.w/2+'" y="30" fill="white" text-anchor="middle" font-size="2em" letter-spacing="0.2em" lengthAdjust="spacing" > '+this.title+" </text>\n\t\t\t\t\t\t\t</g>\n\t\t\t\t\t</svg>\n\n\t\t\t\t"}},{key:"renderBoder2",value:function(){var t=this.id;return'\n\t\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg"  xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 '+(950*this.w+20)+" "+(500*this.h+20)+'" preserveAspectRatio="none">\n\t\t\t\t\t\t\t<defs >\n\t\t\t\t\t\t\t\t\t<linearGradient id="line'+t+'" gradientUnits="objectBoundingBox">\n\t\t\t\t\t                  <stop offset="0" stop-color="#2c93d2"/>\n\t\t\t\t\t                  <stop offset="1" stop-color="#3fbccf"/>\n\t\t\t\t\t              \t</linearGradient>\n\t\t\t\t\t              \t<g id="border'+t+'">\n\t\t\t\t\t\t\t\t\t\t<polygon  fill="" points="'+this.getPath().join(" , ")+'"  \n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t              \t</g>\n\t\t\t\t\t\t\t</defs>\n\n\t\t\t\t\t\t\t<g transform="translate(10 10)" stroke="url(#line'+t+')" stroke-width="5" >\n\t\t\t\t\t\t\t\t\t<use xlink:href="#border'+t+'" fill="#5c90b275"/>\n\t\t\t\t\t\t\t\t\t<defc>三角形</defc>\n\t\t\t\t\t\t\t\t\t<path  fill="none" d="M 0 0 L 50 0 L 0 50 Z"  />\n\t\t\t\t\t\t\t\t\t<defc>斜线</defc>\n\t\t\t\t\t\t\t\t\t<line x1="'+(935+950*(this.w-1))+'" y1="'+(435+500*(this.h-1))+'" x2="'+(885+950*(this.w-1))+'" y2="'+(485+500*(this.h-1))+'"  />\n\t\t\t\t\t\t\t\t\t<line x1="'+(740+850*(this.w-1))+'" y1="0" x2="'+(785+850*(this.w-1))+'" y2="45"  />\n\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t\t<text x="'+(950*this.w-90-150-100*(this.w-1))/2+'" y="50" fill="white" text-anchor="middle" font-size="2em" letter-spacing="0.2em" lengthAdjust="spacing" > '+this.title+" </text>\n\n\t\t\t\t\t</svg>\n\n\t\t\t\t"}},{key:"renderBoder3",value:function(){var t=this.id;return'\n\t\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg"  xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 '+(950*this.w+20)+" "+(500*this.h+20)+'" preserveAspectRatio="none">\n\t\t\t\t\t\t\t<defs >\n\t\t\t\t\t\t\t\t\t<linearGradient id="line'+t+'" gradientUnits="objectBoundingBox">\n\t\t\t\t\t                  <stop offset="0" stop-color="#2c93d2"/>\n\t\t\t\t\t                  <stop offset="1" stop-color="#3fbccf"/>\n\t\t\t\t\t              \t</linearGradient>\n\t\t\t\t\t              \t<filter width="100%" height="100%" x="0" y="0" id="blur'+t+'" filterUnits="objectBoundingBox">\n\t\t\t\t\t\t\t\t  \t\t<feGaussianBlur stdDeviation="5" in="SourceGraphic" />\n\t\t\t\t\t\t\t\t\t</filter>\n\t\t\t\t\t              \t<g id="border'+t+'" stroke-opacity="0.8">\n\t\t\t\t\t\t\t\t\t\t<rect x="0" y="0" rx="15" ry="15" width="'+950*this.w+'" height="'+500*this.h+'" />\n\t\t\t\t\t              \t</g>\n\t\t\t\t\t              \t<g id="title'+t+'" transform="translate(30 20)" stroke-width="2">\n\t\t\t\t\t\t\t\t\t\t<polygon  fill="none" points="0 0 ,800 0 ,800 30,770 60,0 60" />\n\t\t\t\t\t              \t</g>\n\t\t\t\t\t              \t<g id="radius'+t+'" stroke-width="6"  stroke="#3fbccf">\n\t\t\t\t\t\t\t\t\t\t<path d="M55 0 h-40 A15 15 0 0 0 0 15 v40"  fill="none" stroke-linecap="round" />\n\t\t\t\t\t              \t</g>\n\t\t\t\t\t\t\t</defs>\n\n\t\t\t\t\t\t\t<g transform="translate(10 10)" stroke="url(#line'+t+')" stroke-width="3" fill="none">\n\t\t\t\t\t\t\t\t\t<use xlink:href="#border'+t+'" fill="#5c90b275"/>\n\t\t\t\t\t\t\t\t\t<defc>标题</defc>\n\t\t\t\t\t\t\t\t\t<use xlink:href="#title'+t+'" />\n\t\t\t\t\t\t\t\t\t<use xlink:href="#radius'+t+'"  />\n\t\t\t\t\t\t\t\t\t<use xlink:href="#radius'+t+'"  transform="scale(-1 1) translate('+950*-this.w+' 0)"/>\n\t\t\t\t\t\t\t\t\t<use xlink:href="#radius'+t+'" transform="scale(1 -1) translate(0 '+500*-this.h+')" />\n\t\t\t\t\t\t\t\t\t<use xlink:href="#radius'+t+'" transform="scale(-1 -1) translate('+950*-this.w+" "+500*-this.h+')" />\n \t\t\t\t\t\t\t</g>\n \t\t\t\t\t\t\t<text x="60" y="70" fill="white"  font-size="2em" letter-spacing="0.2em" lengthAdjust="spacing" > '+this.title+" </text>\n\t\t\t\t\t</svg>\n\n\t\t\t\t"}}]),t}();e.Border=a},,,,,,,,,,,,,,,,,function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TimeRealMd=void 0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(12),r=i(0),s=function(){function t(e){!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this);var i=e.modal,n=e.unit,a=e.templateMap;this.modal=i,this.unit=n,this.templateMap=a,this.box=$("#timeRealMd"),this.zbBox=$("#realTreeBox"),this.selBox=$("#realSelZbs"),this.timeRotate=$("#timeRotate"),this.timeVal=$("#timeVal"),this.refreshVal=$("#refreshVal"),this.refreshRotate=$("#refreshRotate"),this.refreshTime=$("#refreshTime"),this.$refreshTimeSel=$("#refreshTimeSel"),this.selZbArr=null,this.init(),this.handle()}return n(t,[{key:"init",value:function(){}},{key:"upModalStatus",value:function(e){this.activeBox=e,this.modal.show(this.box),t.status="create"}},{key:"renderTreeData",value:function(t,e,i){this.dimTree=i,this.orgWd=new r.SComboTree($("#realOrg"),{prompt:"请选择科室...",treeConfig:{clickAndCheck:!0,data:t,childIcon:"sicon sicon-org",idField:"dim_value",textField:"dim_name",childrenField:"sub",judgeRelation:function(t){return"0"===t.type}}}),this.zbTree=new r.Tree($("#realTree"),{clickAndCheck:!1,checkbox:!0,data:e,idField:"kpi_id",textField:"kpi_name",childIcon:"sicon sicon-kpi",childrenField:"sub",judgeRelation:function(t){return"0"===t.kpi_type}})}},{key:"setModalSel",value:function(e,i){var n=i.viewData;this.activeBox=e,this.modal.show(this.box);var a=n.tabInfo,r=a.kpis,s=void 0===r?[]:r,o=a.kpi_infos,l=void 0===o?[]:o,c=a.orgs,d=a.time_id,u=a.time_start,h=a.ref_time,p=a.ref_frequency,f=a.tab_style,m=s.map(function(t){return t.id}),v=l.map(function(t){return t.kpi_id}),b=l.map(function(t){return{kpiId:t.kpi_id,dimId:t.dim_id,dimVal:t.dim_val}}),y=m.concat(v);this.setZbTree(y,b),this.refreshTime.prop("checked","0"!==p),"0"!==p&&this.$refreshTimeSel.show()||this.$refreshTimeSel.hide(),this.orgWd.setValue(c[0].id),this.timeVal.val(u),this.timeRotate.val(d.split("_")[1]),this.timeVal.removeClass("no-fill"),"0"!==p&&this.refreshVal.val(h),"0"!==p&&this.refreshRotate.val(p),"0"!==p&&this.refreshVal.removeClass("no-fill"),$(".real-style").eq(f-1).prop("checked",!0),t.status="edit"}},{key:"setZbTree",value:function(t,e){this.zbTree.setValue(t),this.sureBtnHandle(e)}},{key:"sureBtnHandle",value:function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],i=this.zbTree.getValue("all"),n=i.map(function(t){return t.kpi_id});n.length&&(a.api.GroupKpiByDim({kpi:n}).then(function(n){var a=Object.entries(n);t.selZbArr=i.map(function(t){return{id:t.kpi_id,text:t.kpi_name,isRef:"0"}});var r=1===a.length,s=a.map(function(e){var n=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var i=[],n=!0,a=!1,r=void 0;try{for(var s,o=t[Symbol.iterator]();!(n=(s=o.next()).done)&&(i.push(s.value),!e||i.length!==e);n=!0);}catch(t){a=!0,r=t}finally{try{!n&&o.return&&o.return()}finally{if(a)throw r}}return i}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}(e,2),a=n[0],s=n[1],o=a.split("_")[1],l=r&&i||i.filter(function(t){return s.includes(t.kpi_id)}),c="2"!==o&&t.findDimData(o)||null;return'<div class="dim-item '+("2"!==o?"dim-wdItem":"")+'" dim-id="'+o+'" >'+l.map(function(e){return t.renderZb(e,c)}).join("")+"</div>"});t.selBox.html(s.join("")),t.renderDimBox(e)}),this.modal.close(this.zbBox,"active"))}},{key:"findDimData",value:function(t){var e=null;return function i(n){return n.find(function(n){var a=n.dim_id==t;a&&(e=n);var r=n.sub;return r.length&&!a&&i(r)||a})}(this.dimTree),e}},{key:"renderDimBox",value:function(t){var e=this,i=this;t?t.map(function(t){var n=t.dimVal,a=t.kpiId,s=t.dimId,o=$("#realSelZbs .dimCombobox[kpi_id="+a+"]"),l=e.findDimData(s),c=l.dim_name;new r.SCombobox(o,{data:l.sub,textField:"dim_name",idField:"dim_value",defaultVal:n,width:300,clickCallback:function(t){var e=null,n=i.selZbArr.find(function(t,i){var n=t.id===a||t.kpi_id===a;return e=n?i:null,n}),r=t.dim_id,s=t.dim_name,o=t.dim_value,l={dim_id:r,dim_name:c,dim_val:o,dim_val_name:s,isRef:"0",kpi_id:a,kpi_name:n.text};i.selZbArr[e]=l}})}):$.map($("#realSelZbs .dimCombobox"),function(t){var n=$(t),a=n.closest(".dim-wdItem").attr("dim-id"),s=e.findDimData(a),o=s.dim_name,l=n.attr("kpi_id");new r.SCombobox(n,{data:s.sub,textField:"dim_name",idField:"dim_value",width:300,clickCallback:function(t){var e=null,n=i.selZbArr.find(function(t,i){var n=t.id===l||t.kpi_id===l;return e=n?i:null,n}),a=t.dim_id,r=t.dim_name,s=t.dim_value,c={dim_id:a,dim_name:o,dim_val:s,dim_val_name:r,isRef:"0",kpi_id:l,kpi_name:n.text};i.selZbArr[e]=c}})})}},{key:"renderZb",value:function(t,e){var i=t.kpi_name,n=t.kpi_id,a="";if(e){var r=e.dim_name;e.dim_value,a=' <div class="zb-item-box">\n\t\t\t\t\t\t<div >\n\t\t\t\t\t\t\t<button class="s-btn zb-name dim-zb" echo-id="'+n+'">\n\t\t\t\t\t\t\t\t<i class="fa fa-times-circle del-zb"></i>\n\t\t\t\t\t\t\t\t<b>'+i+'</b>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="sel-item zb-dim-combobox" >\n\t\t\t\t\t\t\t<span >'+r+':&nbsp;</span>\n\t\t\t\t\t\t\t<div class="s-comboBox dimCombobox" kpi_id="'+n+'">\n\t\t\t\t\t\t  </div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t'}else a='<span class="zb-item-box">\n\t\t\t   \t\t\t<button class="s-btn zb-name" echo-id="'+n+'">\n\t   \t\t\t\t\t\t<i class="fa fa-times-circle del-zb"></i>\n\t\t\t\t\t\t\t<b>'+i+"</b>\n\t\t\t\t\t    </button>\n\t\t\t\t    </span>";return a}},{key:"preReal",value:function(){var e=this,i=this.selZbArr;if(i&&i.length){var n=[],r=[];i.forEach(function(t){t.hasOwnProperty("id")?n.push(t):r.push(t)});var s=this.orgWd.getValue("all").map(function(t){return{id:t.dim_value,text:t.dim_name}}),o=this.timeRotate.val(),l=this.timeVal.val(),c=this.refreshTime.prop("checked"),d=c&&this.refreshVal.val()||"0",u=c&&this.refreshRotate.val()||"0",h={time_id:("0"===l?"@":"_")+o,orgs:s,time_start:l,kpis:n,userColumnId:-1,startTime:null,endTime:null,chartName:"",kpi_infos:r,row_wd:["1"],col_wd:["3"],isAdded:"0",tab_style:$(".real-style:checked").val(),total:"0",ref_time:d,ref_frequency:u,isMerge:"1",isDsType:"1",dim_x:!1};a.api.getTableInfo(h).then(function(i){var n=t.status;e.templateMap.add(i,e.activeBox,{type:"timeReal",borderType:"0",viewTitle:""},n)})}else this.unit.tipToast("请选择指标！",2)}},{key:"handle",value:function(){var t=this,e=t.zbBox,i=this.$refreshTimeSel;this.selBox.on("click",".del-zb",function(){var e=$(this),i=e.parent().attr("echo-id");t.zbTree.box.find(".tree-inp[value="+i+"]").click(),e.closest(".zb-item-box").remove(),t.sureBtnHandle()}),$("#realSelZb").click(function(){e.hasClass("active")||t.modal.show(e,"active")}),this.refreshTime.click(function(){$(this).prop("checked")&&i.show()||i.hide()}),$("#realZbOpt").on("click",".s-btn",function(){switch($(this).index()){case 0:t.sureBtnHandle();break;case 1:t.modal.close(t.zbBox,"active")}}),$("#realPre").click(function(){t.box.find(".no-fill:visible").length?t.unit.tipToast("请填完数据！",2):t.preReal()})}}]),t}();s.status="",e.TimeRealMd=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=function(){function t(e){!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this);var i=e.modal,n=e.unit,a=e.templateMap;this.modal=i,this.unit=n,this.templateMap=a,this.editBox=$("#editBox"),this.editMd=$("#editViewMd"),this.editFrame=null,this.handle()}return n(t,[{key:"init",value:function(e){if(t.loading)this.editFrame[0].contentWindow.$summernote.summernote("code",e);else{var i='<iframe src="'+window.jsp_config.resourse+'assert/summernote-develop/index.html"  frameborder="0" style="width: 100%;height: 100%" id="editIframe"></iframe>';this.editBox.html(i),this.editFrame=this.editBox.find("#editIframe"),t.loading=!0,this.editFrame[0].onload=function(){e&&this.contentWindow.$summernote.summernote("code",e)}}}},{key:"setModalSel",value:function(e,i){var n=i.viewData;this.activeBox=e,t.status="edit",this.init(n),this.modal.show(this.editMd)}},{key:"upModalStatus",value:function(e){this.activeBox=e,t.status="create",this.init(),this.modal.show(this.editMd)}},{key:"preEdit",value:function(){if(this.editFrame){var e=this.editFrame[0].contentWindow.$summernote.summernote("code"),i=t.status,n=this.activeBox;this.templateMap.add(e,n,{borderType:"0",type:"editView",viewTitle:""},i)}}},{key:"handle",value:function(){var t=this;$("#editPre").click(function(){t.preEdit()})}}]),t}();a.loading=!1,a.status=null,e.Summernote=a},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TemplateMap=void 0;var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=i(13),s=i(12),o=function(){function t(){!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.viewsMap=new Map,window.viewsMap=this.viewsMap}return a(t,[{key:"init",value:function(t,e){var i=this;t.forEach(function(t,a){var r={attributeObj:n({createId:""},e[a]),viewData:null,timer:null};i.viewsMap.set(t,r)})}},{key:"findViewByPoint",value:function(t){var e=this,i=null,n=[].concat(function(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}(this.viewsMap.keys())).find(function(n){var a=e.viewsMap.get(n),r=a.attributeObj.point[2]===t;return i=r&&a||null,r});return{value:i,dom:n}}},{key:"ceateView",value:function(t,e,i){var n=i.attributeObj,a=n.borderType,s=n.createId,o=n.size,l=n.type,c=i.viewData,d=("0"===a?"":'<div class="bgSvg"></div>')+'<div class="view-content"></div>';t.html(d);var u=["line","pie","scatter","bar","rader"].includes(l)?"chart":l,h=new r.View(t,{id:s,type:u,index:s,viewTitle:e,borderType:a,size:o},c,"2");this.IntervalreFresh(l,h,i)}},{key:"clearRefresh",value:function(t){t.timer&&(clearInterval(t.timer),t.timer=null)}},{key:"IntervalreFresh",value:function(t,e,i){switch(t){case"timeReal":var n=i.viewData.tabInfo,a=n.ref_time,r=n.ref_frequency;if("0"!==r){var o=1e3*a*["",1,60,3600][+r];i.timer=setInterval(function(){s.api.getTableInfo(i.viewData.tabInfo).then(function(t){e.timeReal.size=i.attributeObj.size,e.timeReal.init(t)})},o)}}}},{key:"getDelArr",value:function(){return t.delArr}},{key:"initAdd",value:function(e,i,n){var a=++t.MapID,r=this.viewsMap.get(e[0]);r.viewData=n,r.attributeObj.createId=a,this.ceateView(e,i,r)}},{key:"add",value:function(e,i,n,a){var r=n.borderType,s=n.type,o=n.viewTitle,l=this.viewsMap.get(i[0]),c=l.attributeObj,d=(c.size,c.createId),u=c.viewID;this.clearRefresh(l);var h=d;if(l.viewData=e,l.attributeObj.borderType=r,l.attributeObj.type=s,"replace"===a){var p=n.createId,f=n.viewID;l.attributeObj.createId=p,l.attributeObj.viewID=f}"create"===a?(h=++t.MapID,l.attributeObj.createId=h):"edit"===a&&u&&(l.attributeObj.viewID="","editView"!==s&&t.delArr.push(u)),i.addClass("view-fill"),this.ceateView(i,o,l)}},{key:"delChart",value:function(t){return s.api.deleteChart(t)}},{key:"remove",value:function(e){e.removeClass("view-fill").html(null);var i=this.viewsMap.get(e[0]);this.clearRefresh(i);var n=i.attributeObj,a=n.size,r=n.point,s=n.viewID,o=n.type;s&&"editView"!==o&&t.delArr.push(s),i.attributeObj=null,i.attributeObj={size:a,point:r,viewID:"",createId:"",borderType:"0",type:"",par:""},i.viewData=null}},{key:"getMap",value:function(){return this.viewsMap}}]),t}();o.MapID=0,o.delArr=[],e.TemplateMap=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.handle()}return n(t,[{key:"init",value:function(){}},{key:"handle",value:function(){var t=$(".component-item");$.map(t,function(t){t.onselectstart=function(){return!1},t.ondragstart=function(t){var e=t.target.getAttribute("echo-type");return console.log(e,"startDrop"),t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("type",e),t.dataTransfer.setDragImage(t.target,0,0),!0},t.ondragend=function(t){return t.dataTransfer.clearData("type"),!1}})}}]),t}();e.ViewComponet=a},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ZbComponent=void 0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(0),r=i(12);function s(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}var o=function(){function t(e){!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this);var i=e.kpiTree,n=e.dimTree,a=e.modal,r=e.getViewModal;e.unit,this.dimTree=n,this.getViewModal=r,this.modal=a,this.zbBox=$("#zbTreeBox"),this.selZbs=$("#selZbs"),this.publicDimEl=$("#publicDim"),this.init(i),this.handle()}return n(t,[{key:"init",value:function(t){this.zbTree=new a.Tree($("#zbTree"),{clickAndCheck:!1,checkbox:!0,data:t,idField:"kpi_id",textField:"kpi_name",childIcon:"sicon sicon-kpi",childrenField:"sub",judgeRelation:function(t){return"0"===t.kpi_type}})}},{key:"findDimData",value:function(t){var e=null;return function i(n){return n.find(function(n){var a=n.dim_id==t;a&&(e=n);var r=n.sub;return r.length&&!a&&i(r)||a})}(this.dimTree),e}},{key:"relaodXYCombo",value:function(t,e,i,n){if(t.wd_arr=e,n){var a=void 0,r=void 0;if("pie"!==t.viewType){var s=n.xAxis,o=n.yAxis;a=i.filter(function(t){return!s.includes(t.id)}),r=t.wd_arr.filter(function(t){return!o.includes(t.id)})}else a=i,r=t.wd_arr;t.yAxis.loadData(a),t.xAxis.loadData(r),this.setCommonVal(n,t)}else t.yAxis.loadData(i),t.xAxis.loadData(t.wd_arr)}},{key:"classifyZb",value:function(e,i,n){var a=this,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:[],l=arguments[4];r.api.GroupKpiByDim({kpi:e}).then(function(r){if(r){var c=t.wd_arr_common,d=Object.keys(r),u=1===d.length&&"dim_2"!==d[0];a.publicDim=u,a.publicDimArr=d,a.isOneZb=1<e.length;var h="table"===n.viewType?[].concat(s(c),[{id:"3",text:"指标"},{id:"4",text:"维度值"}]):[].concat(s(c),[{id:"3",text:"维度值"}]),p="table"!==n.viewType?a.isOneZb?[{id:"4",text:"指标"}]:[].concat(s(h),[{id:"4",text:"指标"}]):h,f=void 0;if(u){f='<div class="publicDim dim-item" >'+i.map(function(t){return a.renderZb(t,{key:"dim_2",dimName:""})}).join("")+"</div>";var m=d[0].split("_")[1],v=a.findDimData(m);n.dimWd.loadData(v.sub),n.dimWd.clearValue(),a.relaodXYCombo(n,h,p,l),a.publicDimEl.show(),a.publicDimEl.attr("dim-id",m),a.publicDimEl.attr("dim-name",v.dim_name)}else f=d.map(function(t){var e=t.split("_")[1],n=i.filter(function(e){return r[t].includes(e.kpi_id)}),s=null;if("2"!=e){var o=a.findDimData(e);s=o.dim_name}var l=n.map(function(e){return a.renderZb(e,{key:t,dimName:s})});return'<div class="dim-item" dim-id="'+e+'" dim-name="'+s+'">\n\t\t\t\t\t\t\t\t\t\t\t\t\t'+l.join("")+"\n\t\t\t\t\t\t\t\t\t\t  </div>"}).join(""),a.publicDimEl.hide(),h.pop(),a.relaodXYCombo(n,h,p,l);a.selZbs.html(f),a.renderDimBox(o,d)}else a.unit.tipToast("获取数据出错！",0)})}},{key:"setCommonVal",value:function(t,e){var i=t.xAxis,n=t.yAxis,a=t.orgs,r=t.time_start,s=t.time_id,o=t.pubDimValue,l=null,c=null;"table"===e.viewType?(e.yAxis.setValue(n),e.xAxis.setValue(i),c=i.concat(n),l=["1","2","3","4"].filter(function(t){return!c.includes(t)})):(e.yAxis.setValue(n),e.xAxis.setValue(i),c="pie"===e.viewType&&[i]||[i,n],l=["1","2","3","4"].filter(function(t){return!c.includes(t)}));var d="table"===e.viewType?"4":"3";l.forEach(function(t){switch(t){case"1":e.calendar.setTime([s]);break;case"2":e.orgWd.setValue(a[0]);break;case d:o.length&&e.dimWd.setValue(o)}}),c.forEach(function(t){switch(t){case"1":e.calendar.changeStyle(2,[s,r]);break;case"2":e.orgWd.changeType(!0,a);break;case d:e.dimWd.config.multiply=!0,e.dimWd.setValue(o)}})}},{key:"renderDimBox",value:function(t,e){var i=this;t.length?t.map(function(t){var e=t.dimVal,n=t.kpiId,r=t.dimId,s=$("#selZbs .dimCombobox[kpi_id="+n+"]"),o=i.findDimData(r).sub;new a.SCombobox(s,{data:o,textField:"dim_name",idField:"dim_value",defaultVal:e})}):1<e.length&&$.map($("#selZbs .dim-item"),function(t){var e=$(t).attr("dim-id");if(2!=e){var n=$(t).find(".dimCombobox"),r=i.findDimData(e).sub;new a.SCombobox(n,{data:r,textField:"dim_name",idField:"dim_value"})}})}},{key:"renderZb",value:function(t,e){var i=t.kpi_name,n=t.kpi_id,a=e.key,r=e.dimName;return"dim_2"!==a?'\n\t\t\t\t\t<div class="sel-item zb-item-box">\n\t\t\t\t\t\t<div >\n\t\t\t\t\t\t\t<button class="s-btn zb-name dim-zb" echo-id="'+n+'">\n\t\t\t\t\t\t\t\t<i class="fa fa-times-circle del-zb"></i>\n\t\t\t\t\t\t\t\t<b>'+i+'</b>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="sel-item zb-dim-combobox" >\n\t\t\t\t\t\t\t<span >'+r+':</span>\n\t\t\t\t\t\t\t<div class="s-comboBox dimCombobox" kpi_id="'+n+'">\n\t\t\t\t\t\t  </div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t':'<span class="zb-item-box">\n\t\t\t   \t\t\t<button class="s-btn zb-name" echo-id="'+n+'">\n\t   \t\t\t\t\t\t<i class="fa fa-times-circle del-zb"></i>\n\t\t\t\t\t\t\t<b>'+i+"</b>\n\t\t\t\t\t    </button>\n\t\t\t\t    </span>"}},{key:"setZbTree",value:function(t,e){var i=null,n=null,a=[];if("table"===t){var r=e.kpi_infos,s=void 0===r?[]:r,o=e.kpis,l=(e.dim_x,e.time_start),c=e.time_id,d=e.orgs,u=e.row_wd,h=e.col_wd,p=e.pub_dim_vals,f=void 0===p?[]:p,m=o.map(function(t){return t.id}),v=s.map(function(t){var e=t.kpi_id,i=t.dim_val,n=t.dim_id;return a.push({dimVal:i,kpiId:e,dimId:n}),e});i=m.concat(v),n={time_start:l,time_id:c,orgs:d.map(function(t){return t.id}),xAxis:u,yAxis:h,pubDimValue:f.map(function(t){return t.id})}}else{var b=e.kpisDimX,y=void 0===b?[]:b,w=e.kpis,g=(e.dim_x,e.time_start),x=e.time_id,k=e.orgs,T=e.contrastDim,C=e.rowDim,_=e.pubDimValue,S=void 0===_?[]:_,D=w.map(function(t){return t.id}),j=y.map(function(t){var e=t.kpiId,i=t.dimVal,n=t.dimId;return a.push({dimVal:i,kpiId:e,dimId:n}),e});i=D.concat(j),n={time_start:g,time_id:x,orgs:k.map(function(t){return t.id}),xAxis:C,yAxis:T,pubDimValue:S.map(function(t){return t.id})}}return i&&this.zbTree.setValue(i),{commonObj:n,dim_vals:a}}},{key:"sureBtnHandle",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",n=i&&this.setZbTree(i,e)||{commonObj:null,dim_vals:[]},a=n.commonObj,r=n.dim_vals,s=this.zbTree.selArr,o=s.map(function(t){return t.kpi_id});o.length&&(this.classifyZb(o,s,t,r,a),this.modal.close(this.zbBox,"active"))}},{key:"handle",value:function(){var t=this,e=this.getViewModal();$("#selZb").click(function(){var e=t.zbBox;e.hasClass("active")||t.modal.show(e,"active")}),this.selZbs.on("click",".del-zb",function(){var i=$(this),n=i.closest(".zb-item-box"),a=i.parent().attr("echo-id");t.zbTree.box.find(".child-checkinp[value="+a+"]").click(),n.remove(),t.sureBtnHandle(e)}),$("#zbOpt").on("click",".s-btn",function(){switch($(this).index()){case 0:t.sureBtnHandle(e);break;case 1:t.modal.close(t.zbBox,"active")}})}}]),t}();o.wd_arr_common=[{id:"1",text:"时间"},{id:"2",text:"科室"}],e.ZbComponent=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ViewSetModal=void 0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(43),r=i(12),s=i(0),o=function(){function t(e){!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this);var i=e.modal,n=e.unit,a=e.templateMap;this.modal=i,this.unit=n,this.templateMap=a,this.setMd=$("#setComponentMd"),this.modalType=$("#modalType"),this.viewStyleBox=$("#viewStyleBox"),this.$viewSure=$("#viewSure"),this.$componentName=$("#componentName"),this.$legendBox=$("#g-legendBox"),this.viewType="",this.wd_arr=null,this.commonSel=null,this.activeViewObje=null,this.init(),this.handle()}return n(t,[{key:"init",value:function(){var t=this;this.calendar=new s.Calendar($("#calendarTime"),$("#viewShowTime"),{rotate:3,style:1}),this.xAxis=new s.SCombobox($("#XAxis"),{width:300,prompt:"请选择横轴维度...",multiply:!0,clickCallback:function(e,i,n){var a="",r=i.getValue().split(",");requestAnimationFrame(function(){"table"===t.viewType?(a=t.filterAxisData(r),t.yAxis.loadData(a)):t.zbComponent.isOneZb||((a=t.filterAxisData(r)).push({id:"4",text:"指标"}),t.yAxis.loadData(a))}),setTimeout(function(){t.changeSelType(e,n,i.config.multiply)},60)}}),this.yAxis=new s.SCombobox($("#YAxis"),{width:300,prompt:"请选择纵轴维度...",multiply:!0,clickCallback:function(e,i,n){var a=i.getValue().split(",");requestAnimationFrame(function(){var e=t.filterAxisData(a);t.xAxis.loadData(e)}),setTimeout(function(){t.changeSelType(e,n,i.config.multiply)},60)}}),this.dimWd=new s.SCombobox($("#dimWd"),{width:300,prompt:"请选择主题维度...",dropIcon:"sicon sicon-kpi",multiply:!1,idField:"dim_value",textField:"dim_name"})}},{key:"renderTreeData",value:function(t,e,i){var n=this.modal,r=this.unit,o=this;this.orgWd=new s.SComboTree($("#orgWd"),{prompt:"请选择科室...",treeConfig:{clickAndCheck:!0,data:t,childIcon:"sicon sicon-org",idField:"dim_value",textField:"dim_name",childrenField:"sub",judgeRelation:function(t){return"0"===t.type}}}),this.zbComponent=new a.ZbComponent({kpiTree:e,dimTree:i,modal:n,unit:r,getViewModal:function(){return o}})}},{key:"filterAxisData",value:function(t){return this.wd_arr.filter(function(e){return!t.includes(e.id)})}},{key:"changeComboSel",value:function(t,e){var i="table"===this.viewType?"4":"3";switch(t){case"1":var n=e?2:1;this.calendar.changeStyle(n);break;case"2":this.orgWd.changeType(e);break;case i:this.dimWd.config.multiply=e,this.dimWd.clearValue()}}},{key:"changeSelType",value:function(t,e,i){i?this.changeComboSel(t.id,e):(this.changeComboSel(t.id,!0),this.changeComboSel(e,!1))}},{key:"upModalStatus",value:function(e,i){this.activeViewObje={$box:i},t.status="create",this.$componentName.val("");var n=$(".component-item[echo-type="+e+"]").html();this.modalType.html(n),this.viewType=e,this.viewStyleBoxTnit(),this.upComboxStatus(),this.modal.show(this.setMd),this.zbComponent.zbTree.setValue([]),this.zbComponent.selZbs.html("")}},{key:"setModalSel",value:function(e){var i=this.templateMap.viewsMap.get(e[0]),n=i.attributeObj,a=n.type,r=n.borderType,s=i.viewData;e.addClass("view-active").siblings().removeClass("view-active"),t.status="edit",this.activeViewObje={$box:e};var o=$(".component-item[echo-type="+a+"]").html();this.modalType.html(o),this.viewType=a;var l={table:{data:"tabInfo",style:"tab_style"},chart:{style:"tab_style",data:"graphInfo"}}[["line","pie","scatter","bar","rader"].includes(a)?"chart":"table"],c=s[l.data],d=c.chartName,u=c[l.style];$(".legend-place").eq(u-1).prop("checked",!0),$(".border-style").eq(r-1).prop("checked",!0),this.$componentName.val(d),this.viewStyleBoxTnit(c),this.upComboxStatus(),this.modal.show(this.setMd),this.zbComponent.sureBtnHandle(this,c,a)}},{key:"upComboxStatus",value:function(){var e="table"===this.viewType,i=this.xAxis.box.parent();"pie"===this.viewType&&i.hide()||i.show(),this.xAxis.config.multiply=e,this.yAxis.config.multiply=e,this.dimWd.config.multiply=!1,"create"===t.status&&(this.xAxis.clearValue(),this.yAxis.clearValue(),this.dimWd.clearValue(),this.orgWd.changeType(!1),this.calendar.changeStyle(1))}},{key:"viewStyleBoxTnit",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this[{table:"tableInit",line:"lineInit",bar:"barInit",pie:"pieInit",scatter:"scatterInit",rader:"raderInit"}[this.viewType]](t)}},{key:"getChartCommonInit",value:function(t){this.$legendBox.show();var e=t.split(","),i=["",'checked="checked"'];return{axis:'<div class="sel-item">\n\t\t\t\t\t\t\t<div class="sel-item">\n\n\t\t\t\t\t\t\t\t<span class="s-title">X轴:</span>\n\t\t\t\t\t\t\t   \t<span class="s-switch" echo-text="不显示" style="width: 100px">\n\t\t\t\t\t\t\t\t\t<input type="checkbox" id="Xaixs" '+i[+e[0]]+'>\n\t\t\t\t\t\t\t\t\t<label for="Xaixs" echo-text="显示"></label>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="sel-item">\n\t\t\t\t\t\t\t\t<span class="s-title">Y轴:</span>\n\t\t\t\t\t\t\t    <span class="s-switch" echo-text="不显示" style="width: 100px">\n\t\t\t\t\t\t\t\t\t<input type="checkbox" id="Yaixs" '+i[+e[1]]+'>\n\t\t\t\t\t\t\t\t\t<label for="aixs" echo-text="显示"></label>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>'}}},{key:"tableInit",value:function(t){this.$legendBox.hide();var e=t.tab_style,i=void 0===e?"0":e,n=(t.isAdded,t.total),a=void 0===n?"0":n,r=["",""];r[+i]='checked="checked"';var o='<div class="sel-item">\n\t\t\t\t    <p class="s-title">表格样式:</p>\n\t\t\t\t    <div>\n\t\t\t\t        <span class="s-radio-box"><input type="radio" class="s-radio" name="tab-style" '+r[0]+' value="0"><label class="m-radio-icon u-tab-lab1"></label></span>\n\t\t\t\t        <span class="s-radio-box"><input type="radio" '+r[1]+' class="s-radio " name="tab-style" value="1"><label class="m-radio-icon u-tab-lab2"></label></span>\n\t\t\t\t    </div>\n\t\t\t\t</div>\n\t\t\t\t<div class="sel-item">\n\t\t\t\t    <p class="s-title">合计:</p>\n\t\t\t\t\t<div class="s-comboBox" id="totalCombo"></div>\n\t\t\t\t</div>\n\t\t\t\t';this.viewStyleBox.html(o);var l="0"===a?[]:"3"===a?["1","2"]:[a];new s.SCombobox($("#totalCombo"),{width:240,prompt:"可多选（非必选）",multiply:!0,validCombo:!1,defaultVal:l,data:[{text:"列字段",id:"1"},{text:"行字段",id:"2"}]})}},{key:"barInit",value:function(t){var e=t.threeD,i=void 0===e?"0,0":e,n=t.stack,a=void 0===n?"0":n,r=t.landscape,s=void 0===r?"0":r,o=this.getChartCommonInit(i).axis,l=["",""];l[+s]='checked="checked"';var c="\n\t\t\t\t\t\t"+o+'\n\t\t\t\t\t\t<div class="sel-item">\n\t\t\t\t\t\t\t<div class="sel-item">\n\t\t\t\t\t\t\t      <p class="s-title">展示样式:</p>\n\t\t\t\t\t\t\t\t  <div>\n\t\t\t\t\t\t\t\t        <span class="s-radio-box"><input type="radio" '+l[0]+' class="s-radio u-radio-sel" name="bar-style" checked="checked" value="0"><label class="m-radio-icon u-bar-lab1"></label></span>\n\t\t\t\t\t\t\t\t        <span class="s-radio-box"><input type="radio" '+l[1]+' class="s-radio u-radio-sel" name="bar-style" value="1"><label class="m-radio-icon u-bar-lab2"></label></span>\n\t\t\t\t\t\t\t\t  </div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="sel-item">\n\t\t\t\t\t\t\t\t<span class="s-title">堆叠:</span>\n\t\t\t\t\t\t\t    <label class="s-switch-2">\n\t\t\t\t\t\t\t\t\t\t<input type="checkbox" class="stack" name="stack" '+("1"===a?'checked="checked"':"")+' >\n\t\t\t\t\t\t\t\t\t\t<span class="switch-ball"></span>\n\t\t\t\t\t\t    \t</label>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t';this.viewStyleBox.html(c)}},{key:"lineInit",value:function(t){var e=t.threeD,i=void 0===e?"0,0":e,n=t.landscape,a=void 0===n?"0":n,r=this.getChartCommonInit(i).axis,s=["",""];s[+a]='checked="checked"';var o="\n\t\t\t\t\t\t"+r+'\n\t\t\t\t\t\t<div class="sel-item">\n\t\t\t\t\t\t\t<div class="sel-item">\n\t\t\t\t\t\t\t      <p class="s-title">展示样式:</p>\n\t\t\t\t\t\t\t\t  <div>\n\t\t\t\t\t\t\t\t        <span class="s-radio-box"><input type="radio" '+s[0]+' class="s-radio u-radio-sel" name="line-style"  value="0"><label class="m-radio-icon u-line-lab1"></label></span>\n\t\t\t\t\t\t\t\t        <span class="s-radio-box"><input type="radio" '+s[1]+'  class="s-radio u-radio-sel" name="line-style" value="1"><label class="m-radio-icon u-line-lab2"></label></span>\n\t\t\t\t\t\t\t\t  </div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t';this.viewStyleBox.html(o)}},{key:"pieInit",value:function(t){this.$legendBox.show();var e=t.roseType,i=["","","",""];i[(void 0===e?"0":e)-1]='checked="checked"';var n='\n\t\t\t\t\t\t<div class="sel-item">\n\t\t\t\t\t\t\t<div class="sel-item">\n\t\t\t\t\t\t\t      <p class="s-title">展示样式:</p>\n\t\t\t\t\t\t\t\t  <div>\n\t\t\t\t\t\t\t\t        <span class="s-radio-box"><input type="radio" '+i[0]+' class="s-radio u-radio-sel" name="pie-style"  value="1"><label class="m-radio-icon u-pie-lab1"></label></span>\n\t\t\t\t\t\t\t\t        <span class="s-radio-box"><input type="radio" '+i[1]+'  class="s-radio u-radio-sel" name="pie-style" value="2"><label class="m-radio-icon u-pie-lab2"></label></span>\n\t\t\t\t\t\t\t\t         <span class="s-radio-box"><input type="radio" '+i[2]+' class="s-radio u-radio-sel" checked="checked" name="pie-style"  value="3"><label class="m-radio-icon u-pie-lab3"></label></span>\n\t\t\t\t\t\t\t\t        <span class="s-radio-box"><input type="radio"  '+i[3]+' class="s-radio u-radio-sel" name="pie-style" value="4"><label class="m-radio-icon u-pie-lab4"></label></span>\n\t\t\t\t\t\t\t\t  </div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t';this.viewStyleBox.html(n)}},{key:"raderInit",value:function(t){this.$legendBox.show();var e=t.area,i=["",""];i[+(void 0===e?"0":e)]='checked="checked"';var n='\n\t\t\t\t\t\t<div class="sel-item">\n\t\t\t\t\t\t\t<div class="sel-item">\n\t\t\t\t\t\t\t      <p class="s-title">展示样式:</p>\n\t\t\t\t\t\t\t\t  <div>\n\t\t\t\t\t\t\t\t        <span class="s-radio-box"><input type="radio" class="s-radio u-radio-sel" name="rader-style" '+i[0]+' value="0"><label class="m-radio-icon u-rader-lab1"></label></span>\n\t\t\t\t\t\t\t\t        <span class="s-radio-box"><input type="radio"  class="s-radio u-radio-sel" '+i[1]+' name="rader-style" value="1"><label class="m-radio-icon u-rader-lab2"></label></span>\n\t\t\t\t\t\t\t\t  </div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t';this.viewStyleBox.html(n)}},{key:"scatterInit",value:function(t){var e=t.threeD,i=void 0===e?"0,0":e,n=t.landscape,a=["",""];a[+(void 0===n?"0":n)]='checked="checked"';var r="\n\t\t\t\t\t\t"+this.getChartCommonInit(i).axis+'\n\t\t\t\t\t\t<div class="sel-item">\n\t\t\t\t\t\t\t<div class="sel-item">\n\t\t\t\t\t\t\t      <p class="s-title">展示样式:</p>\n\t\t\t\t\t\t\t\t  <div>\n\t\t\t\t\t\t\t\t        <span class="s-radio-box"><input type="radio" class="s-radio u-radio-sel" '+a[0]+' name="scatter-style"  value="0"><label class="m-radio-icon u-scatter-lab1"></label></span>\n\t\t\t\t\t\t\t\t        <span class="s-radio-box"><input type="radio" '+a[1]+' class="s-radio u-radio-sel" name="scatter-style" value="1"><label class="m-radio-icon u-scatter-lab2"></label></span>\n\t\t\t\t\t\t\t\t  </div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t';this.viewStyleBox.html(r)}},{key:"getCommonValue",value:function(t,e){var i={table:{xField:"row_wd",yField:"col_wd",dimZbField:"kpi_infos",dimIdField:"dim_id",kpiField:"kpi_id",nameField:"kpi_name",dimNameField:"dim_name",dimValField:"dim_val",dimNameValField:"dim_val_name",pubDimIdField:"pub_dim_id",pubDimNameField:"pub_dim_name",pubDimValsField:"pub_dim_vals"},chart:{xField:"rowDim",yField:"contrastDim",dimZbField:"kpisDimX",dimIdField:"dimId",kpiField:"kpiId",nameField:"kpiName",dimNameField:"dimName",dimNameValField:"dimValName",dimValField:"dimVal",pubDimIdField:"pubDimId",pubDimNameField:"pubDimName",pubDimValsField:"pubDimValue"}},n="table"===t&&this.xAxis.getValue().split(",")||this.xAxis.getValue(),a="table"===t&&this.yAxis.getValue().split(",")||this.yAxis.getValue(),r=this.viewType,s=this.$componentName.val().trim(),o=this.orgWd.getValue("all").map(function(t){var e=t.dim_value,i=(t.dim_value,{id:e,text:t.dim_name});return"line"!==r&&"bar"!==r||(i.lineType="line"===r?"1":"2"),i}),l=(this.calendar.style,this.calendar.value),c=l[0].join(""),d=l[l.length-1].join(""),u=[],h=[],p=$("#selZbs .dim-item"),f=i[t];if(1===p.length){var m=p.find(".zb-name");u=$.map(m,function(t){var e=$(t),i={text:e.children("b").text(),id:e.attr("echo-id")};return"table"===r?i.isRef="0":"line"===r?(i.refName="-无-",i.lineType="1"):"bar"===r&&(i.refName="-无-",i.lineType="2"),i})}else $.map(p,function(t){var e=$(t),i=e.attr("dim-id"),n=e.find(".zb-name"),a=e.attr("dim-name");2==i?u=$.map(n,function(t){var e=$(t),i={text:e.children("b").text(),id:e.attr("echo-id")};return"table"===r?i.isRef="0":"line"===r?(i.refName="-无-",i.lineType="1"):"bar"===r&&(i.refName="-无-",i.lineType="2"),i}):$.map(n,function(t){var e=$(t),n=e.parent().siblings(".zb-dim-combobox"),s=n.find(".combo-text").val(),o=n.find(".combo-value").val(),l={};l[f.kpiField]=e.attr("echo-id"),l[f.nameField]=e.children("b").text(),l[f.dimIdField]=i,l[f.dimNameField]=a,l[f.dimValField]=o,l[f.dimNameValField]=s,"table"===r?l.isRef="0":"line"===r?(l.refName="-无-",l.lineType="1"):"bar"===r&&(l.refName="-无-",l.lineType="2"),h.push(l)})});var v={time_id:c,orgs:o,time_start:d,kpis:u,startTime:null,endTime:null,chartName:s,userColumnId:"0"};return e?(v[i[t].pubDimIdField]=$("#publicDim").attr("dim-id"),v[i[t].pubDimNameField]=$("#publicDim").attr("dim-name"),v[i[t].pubDimValsField]=this.dimWd.getValue(this.dimWd.box,"all").map(function(t){var e={id:t.dim_value,text:t.dim_name};return"line"!==r&&"bar"!==r||(e.lineType="line"===r?"1":"2"),e})):v[i[t].dimZbField]=h,v[i[t].xField]=n,v[i[t].yField]=a,v}},{key:"getTableSet",value:function(){var t=$("#totalCombo").find(".combo-value").val(),e=this.zbComponent.publicDim,i=$("input[name=tab-style]:checked").val(),n=t?t.includes(",")?"3":t:"0";return Object.assign(this.getCommonValue("table",e),{isAdded:"0",tab_style:i,total:n,isMerge:"1",isDsType:"1",dim_x:e})}},{key:"getChartSet",value:function(){var t=this.viewType,e="",i=null,n=$(".legend-place:checked").val(),a=1==this.zbComponent.publicDimArr.length,r=$(".u-radio-sel:checked").val(),s=1===this.zbComponent.publicDimArr.length,o=this.getCommonValue("chart",s);switch(t){case"pie":e="5",i={roseType:r,rowDim:o.contrastDim};break;case"scatter":var l=$("#Xaixs").prop("checked"),c=$("#Yaixs").prop("checked");e="7",i={threeD:Number(l)+","+Number(c),landscape:r};break;case"rader":e="6",i={area:r};break;default:e="4";var d=$("#Xaixs").prop("checked"),u=$("#Yaixs").prop("checked");i={landscape:r,stack:"bar"===t?Number($(".stack").prop("checked")):"0",threeD:Number(d)+","+Number(u),maxVal:"@",minVal:"@",moreAxis:"0"}}return Object.assign(o,i,{chartType:e,isPubDimX:a,legend:n})}},{key:"getSetData",value:function(){var t={table:{set:"getTableSet",url:"getTableInfo",save:"saveTableInfo"},chart:{set:"getChartSet",url:"getGraphInfo",save:"saveGraphInfo"}}[["line","pie","scatter","bar","rader"].includes(this.viewType)?"chart":this.viewType];return{methodType:t,object:this[t.set](),viewType:this.viewType}}},{key:"createView",value:function(){var e=this,i=this.getSetData(),n=i.methodType,a=i.object,s=i.viewType;r.api[n.url](a).then(function(i){if(i.data&&i.data.length){var n=e.activeViewObje.$box,r=$(".border-style:checked").val(),o=t.status,l=a.chartName;e.templateMap.add(i,n,{type:s,borderType:r,viewTitle:l},o)}else e.unit.tipToast("数据获取出错！",0)})}},{key:"handle",value:function(){var t=this,e=this.setMd,i=t.unit;e.on("click",".m-tab",function(n){n.stopPropagation(),2==$(this).index()?t.zbComponent.zbTree.getValue("id").length&&e.addClass("other")||i.tipToast("请先选择指标！",2):e.removeClass("other")}),t.$viewSure.click(function(){0!==t.zbComponent.zbTree.selArr.length?e.find(".no-fill:visible").length?i.tipToast("请填完必填项！",2):t.createView():i.tipToast("请选择指标！",2)}),e.on("click",function(){requestAnimationFrame(function(){var t=$(".combo-drop");t.parent().removeClass("active"),t.hide()})})}}]),t}();o.status="create",e.ViewSetModal=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.HeadOpt=void 0;var n,a=(n=i(9))&&n.__esModule?n:{default:n},r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=i(12),o=i(13),l=i(0);function c(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}var d=window.jsp_config.resourse?"index/lists/":"./",u=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.config=e,this.globalBox=$("#globalBox"),this.parCatalogCombox=$("#parCatalogCombox"),this.init(),this.handle()}var e,i;return r(t,[{key:"init",value:function(){var t=this;this.globalCalendar=new l.Calendar($("#globalCalendar"),null,{hasInp:!1,style:2}),s.api.getAllLayoutPar().then(function(e){if(e.sub){var i=t.config.viewDetail.par_id;t.parCatalogSel=new l.SComboTree(t.parCatalogCombox,{width:350,treeConfig:{data:e.sub,textField:"layout_name",idField:"layout_id",childIcon:"fa fa-folder-open-o",childrenField:"sub",parClick:!0,judgeRelation:function(t){return 0<t.sub.length}}}),t.parCatalogSel.setValue(i)}else t.config.unit.tipToast("获取目录出错！",0)})}},{key:"getSaveViewData",value:function(){return[].concat(c(this.config.templateMap.viewsMap.values())).map(function(t){var e=t.attributeObj;return{size:e.size,point:e.point,viewID:e.viewID,borderType:e.borderType,type:e.type,par:e.par}})}},{key:"saveViews",value:function(t,e){var i={table:"saveTableInfo",chart:"saveGraphInfo",timeReal:"saveTableInfo",editView:"addAssembly"};return[].concat(c(t.keys())).reduce(function(n,a){var r=t.get(a),o=r.attributeObj,l=o.type,c=o.viewID,d=o.createId,u=r.viewData;if(!c&&d){var h=["line","bar","scatter","pie","rader"].includes(l)?"chart":l,p=null;"editView"!==l?p=u[{chart:"graphInfo",table:"tabInfo",timeReal:"tabInfo"}[h]]:(p=new FormData).set("assembly_data",u);var f=s.api[i[h]](p).then(function(t){var i=t.state,n=t.id;if(i)r.attributeObj.viewID=n;else{var a=p.chartName&&"“"+p.chartName+"”"||"";e.tipToast(a+"保存失败,请稍后重新再保存！",0)}return i});n.push(f)}return n},[])}},{key:"saveAllView",value:(e=a.default.mark(function t(){var e,i,n,r,o,l,c,d,u,h,p;return a.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.config,i=e.imgToUrl,n=e.getTemplate,r=e.templateMap.viewsMap,o=e.unit,t.next=3,i(r);case 3:return t.sent,l=this.saveViews(r,o),t.next=7,Promise.all(l);case 7:if(!t.sent.every(function(t){return t})){t.next=23;break}return this.delAllOld(),c=new FormData,window.parent.menuID,d=n(),u=d.htmlStr,h=d.box,p=this.getSaveViewData(),c.set("layout_id",this.config.viewDetail.layout_id),c.set("model",u),c.set("modelData",JSON.stringify(p)),t.next=20,s.api.saveLayout(c).then(function(t){return t?o.tipToast("视图保存成功！",1):o.tipToast("保存失败,请稍后重新再保存！",0),h.html(null),t});case 20:return t.abrupt("return",t.sent);case 23:return!(t.next=25);case 25:return t.abrupt("return",t.sent);case 26:case"end":return t.stop()}},t,this)}),i=function(){var t=e.apply(this,arguments);return new Promise(function(e,i){return function n(a,r){try{var s=t[a](r),o=s.value}catch(a){return void i(a)}if(!s.done)return Promise.resolve(o).then(function(t){n("next",t)},function(t){n("throw",t)});e(o)}("next")})},function(){return i.apply(this,arguments)})},{key:"getViewData",value:function(t){return this.config.templateMap.viewsMap.get(t[0])}},{key:"delAllOld",value:function(){var t=this.config.templateMap,e=t.getDelArr(),i=e.map(function(e){return t.delChart(e)});Promise.all(i).then(function(t){e=[]})}},{key:"handle",value:function(){var t=this,e=this.config,i=e.modal,n=e.viewDetail,a=e.unit,r=(this.getViewData,$("#globalFilter")),l=$("#globalSave");$("#glo-styleClose").click(function(){i.close(t.globalBox,"active")}),$("#headOpt").on("click",".head-btn",function(){switch($(this).attr("sign")){case"filter":r.hasClass("active")?i.close(r,"active"):i.show(r,"active");break;case"style":t.globalBox.hasClass("active")?i.close(t.globalBox,"active"):i.show(t.globalBox,"active");break;case"pre":break;case"save-as":l.hasClass("active")?i.close(l,"active"):i.show(l,"active");break;case"export":break;case"save":t.saveAllView()}}),$("#back").click(function(){var e=$("#slide",window.parent.document),i=$("#content",window.parent.document),n=e.hasClass("collapsed")?45:250;e.animate({width:n},500,function(){var e=t.config.viewDetail.layout_id,n=d+"szViews.html?layout_id="+e;$("#routerConter",window.parent.document).html('<iframe frameborder="0" id="router" name="myFrameName" src="'+n+'"></iframe>'),i.removeClass("no-head")})});var c=$("#viewName");l.on("click",".s-btn",function(){switch($(this).index()){case 0:var e=c.val().trim(),r=n.layout_id,o=t.parCatalogSel.getValue()[0].layout_id;if(!e||!o)return;t.saveAllView().then(function(t){t&&s.api.checkName({name:e,par_id:o}).then(function(t){t?s.api.copyLayout({par_id:o,layoutId:r,layoutName:e}).then(function(t){t?(a.tipToast("另存成功！",1),i.close(l,"active")):a.tipToast("另存失败！",0)}):a.tipToast("该名称已经存在！",2)})});break;case 1:i.close(l,"active")}}),$("#themeSelBox").on("click",".theme-item",function(){var t=$(this),e=t.attr("echo-theme");$("#viewTemplate").attr("echo-theme",e),$("#themeSelBox").find(".active").removeClass("active"),t.addClass("active")}),$("#filterFoot").on("click",".s-btn",function(){if(0===$(this).index()){var e=t.globalCalendar.value;t.config.templateMap.viewsMap.forEach(function(t,i){var n=t.attributeObj,a=n.type,r=n.borderType,l=(n.viewID,n.createId),c=n.size,d=t.viewData,u=["line","bar","scatter","pie","rader"].includes(a)?"chart":a;if(["chart","table"].includes(u)){t.timer&&(clearInterval(t.timer),t.timer=null);var h="chart"===u?"getGraphInfo":"getTableInfo",p="chart"===u&&d.graphInfo||d.tabInfo,f="chart"===u?d.graphInfo.chartName:d.tabInfo.chartName;p.time_id=e[0].join(""),p.time_start=e[1].join(""),s.api[h](p).then(function(e){t.viewData=e,new o.View($(i),{id:l,type:u,index:l,viewTitle:f,borderType:r,size:c},e,"2")})}})}i.close($("#globalFilter"),"active")}),$("#borderSelBox").on("click",".border-item",function(){var e=$(this).attr("echo-border").match(/\d+/g)[0],i=$(".bgSvg");$.map(i,function(i){var n=$(i),a=n.parent(".view-item"),r=t.config.templateMap.viewsMap.get(a[0]);r.attributeObj.borderType=e;var s=r.attributeObj.size,l=r.attributeObj.type,c=r.attributeObj.viewID,d="table"===l&&r.viewData.tabInfo.chartName||r.viewData.graphInfo.chartName;new o.Border(n,{id:c,title:d,borderType:e,size:s})})})}}]),t}();e.HeadOpt=u},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TemplateView=void 0;var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},a=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var i=[],n=!0,a=!1,r=void 0;try{for(var s,o=t[Symbol.iterator]();!(n=(s=o.next()).done)&&(i.push(s.value),!e||i.length!==e);n=!0);}catch(t){a=!0,r=t}finally{try{!n&&o.return&&o.return()}finally{if(a)throw r}}return i}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=i(13),o=i(12),l=i(14);function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var d=function(){function t(){c(this,t)}return r(t,[{key:"move",value:function(t,e){var i=this.resiziEl,n=this.startPointX,r=this.startPointY,s=t.clientX-n,o=t.clientY-r,l={left:-1,middle:0,right:1,t:-1,m:0,b:1},c={left:1,middle:0,right:0,t:1,m:0,b:0},d=this.cellSize,u=d.minWidth,h=d.minHeight,p=(d.minTop,d.minLeft,this.curViewSize),f=p.width,m=p.height,v=p.curTop,b=p.curLeft,y=e.split("-"),w=a(y,2),g=w[0],x=w[1],k=f+s*l[x],T=k<u;k=T&&u||k;var C=m+o*l[g],_=C<h;C=_&&h||C;var S=v+o*c[g];_&&(S=v+(m-h)*c[g]);var D=b+s*c[x];T&&(D=b+(f-u)*c[x]),i.css({width:k,height:C,top:S,left:D})}},{key:"judgeCellOver",value:function(t,e){var i=e.size,n=e.point,a=t.size,r=t.point,s=n[1],o=n[0],l=o+i[0],c=s+i[1],d=r[0],u=r[1],h=d+a[0],p=u+a[1];return d<o||l<h||c<p||u<s}},{key:"showCell",value:function(t){var e=this.config.templateMap,i=["left","middle","right"],n=["t","m","b"],a=t.newView,r=t.oldView,s=t.rotate,o=r.attributeObj,l=o.size,c=o.point,d=a.attributeObj.point,u=i.slice(c[0],+l[0]+c[0]),h=n.slice(c[1],+l[1]+c[1]),p=i.slice(d[0],+s[0]+d[0]),f=n.slice(d[1],+s[1]+d[1]),m=null;h.map(function(t){if(f.includes(t)){var i=u.length,n=p.length,a=i-n,r=a<=0?[]:u[0]===p[0]?u.slice(n):u.slice(0,a);m=r}else m=u;m.map(function(i){var n=t+"-"+i,a=e.findViewByPoint(n),r=a.dom,s=a.value;$(r).removeClass("view-hide").css({"grid-column-end":"span 1","grid-row-end":"span 1"}),s.attributeObj.size=[1,1],s.attributeObj.par=""})})}},{key:"mapHideXaxis",value:function(t,e,i,n,a,r){for(var s=this.config.templateMap,o=!1,l=0,c=t.length;l<c;l++){var d=e+"-"+t[l],u=s.findViewByPoint(d),h=u.dom,p=u.value.attributeObj,f=p.size,m=p.par,v=p.point,b=$(h);if(b.hasClass("view-fill"))return!1;d!==i&&n.push(b);var y=f[0]+f[1];if(b.hasClass("view-hide")&&!a.includes(m)){a.push(m);var w=s.findViewByPoint(m),g=w.dom,x=w.value.attributeObj,k=x.size,T=x.point;if($(g).hasClass("view-fill"))return!1;o=this.judgeCellOver({size:k,point:T},r)}else 2<y&&(a.push(d),o=this.judgeCellOver({size:f,point:v},r));if(o)return!1}return!0}},{key:"hideCell",value:function(t){for(var e=this.config.templateMap,i=["left","middle","right"],n=["t","m","b"],a=t.newView,r=t.oldView,s=t.rotate,o=t.is_changeDom,l=r.attributeObj,c=l.size,d=l.point,u=a.attributeObj.point,h=u[2],p=i.slice(d[0],+c[0]+d[0]),f=n.slice(d[1],+c[1]+d[1]),m=i.slice(u[0],+s[0]+u[0]),v=n.slice(u[1],+s[1]+u[1]),b=[],y=[],w=p.length,g=0,x=v.length;g<x;g++){var k=v[g],T=null;if(f.includes(k)){var C=m.length-w;T=C<=0?[]:p[0]===m[0]?m.slice(w):m.slice(0,C)}else T=m;var _={point:u,size:s};if(!this.mapHideXaxis(T,k,h,b,y,_))return!1}return b.map(function(t){t.addClass("view-hide").css({"grid-column-end":"span 1","grid-row-end":"span 1"});var i=e.viewsMap.get(t[0]).attributeObj;i.size=[1,1],i.par=h}),o&&(t.old.addClass("view-hide"),v.forEach(function(t){m.forEach(function(i){var n=t+"-"+i;n!==h&&(e.findViewByPoint(n).value.attributeObj.par=h)})})),!0}},{key:"mergeCell",value:function(t,e,i){var n=this.resiziEl,r=n.attr("echo-direction").split("-"),s=a(r,2),o=s[0],l=s[1],c=this.config.templateMap,d=i.attributeObj,u=d.size,h=d.point,p=null,f=!1,m=null;if("t"===o||"left"===l){var v=a(t,2),b=v[0],y=v[1],w=a(u,2),g=w[0],x=w[1],k=a(h,2),T=k[0],C={left:-1,middle:0,right:0,t:-1,m:0,b:0},_=["t","m","b"][k[1]+(y-x)*C[o]]+"-"+["left","middle","right"][T+(b-g)*C[l]],S=c.findViewByPoint(_);p=S.value,m=$(S.dom),f=!0}else p=i,m=e;return!!this.hideCell({old:e,news:m,newView:p,oldView:i,rotate:t,is_changeDom:f})&&(this.showCell({newView:p,oldView:i,rotate:t}),p.attributeObj.size,f&&(e.removeClass("view-active").css({"grid-column-end":"span 1","grid-row-end":"span 1"}),i.attributeObj.size=[1,1]),m.addClass("view-active").removeClass("view-hide").css({"grid-column-end":"span "+t[0],"grid-row-end":"span "+t[1]}),p.attributeObj.size=t,p.attributeObj.par="",n.hide(),this.reloadView({newEl:m,oldEl:e},t),!0)}},{key:"reloadView",value:function(t,e){var i=t.newEl,n=t.oldEl,a=this.config.templateMap,r=a.viewsMap.get(n[0]),o=r.attributeObj,l=o.type,c=o.size,d=o.borderType,u=o.viewID,h=o.createId,p=r.viewData;if(i!==n){var f=a.viewsMap.get(i[0]),m=f.attributeObj;m.viewID=u,m.createId=h;var v={borderType:d,type:m.type=l,viewTitle:"editView"!==l?p["table"===l||"timeReal"===l?"tabInfo":"graphInfo"].chartName:"",viewID:u,createId:h};a.add(p,i,v,"replace"),f.attributeObj.size=e,this.delViewData(n)}else{var b=void 0;switch(["line","pie","bar","scatter","rader"].includes(l)?"chart":l){case"table":new s.STable(i.find(".view_main"),{border:d},p),b=p.tabInfo.chartName;break;case"chart":echarts.getInstanceByDom(i.find(".view_main")[0]).resize(),b=p.graphInfo.chartName;break;case"timeReal":var y=1/(p.tabInfo.tab_style*c[0])*100-2;i.find(".timeItem").css("width",y+"%")}if("0"!==d){var w=i.find(".bgSvg");new s.Border(w,{id:u,title:b,size:c,borderType:d})}r.attributeObj.size=e}}}]),t}(),u=function(t){function e(t,i){c(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.config=i,n.box=t,n.resiziEl=$("#m-resize"),n.gLayout=$("#g-layout"),n.templateBox=$("#templateBox"),n.templateContainer=$("#g-templateDom"),n.startPointX=null,n.startPointY=null,n.cellSize=null,n.changeStatus=!1,n.init(),n.handle(),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,d),r(e,[{key:"imgToUrl",value:function(t){var e=$(".editView_main img").not(".has_url");if(!e.length)return!0;var i=Array.from(e).map(function(t){return t.src.includes("data:image")?t.src.split(",")[1]:""});return o.api.upload(i).then(function(i){return i&&(Object.entries(i).forEach(function(t){var i=a(t,2),n=i[0],r=i[1];r&&e.eq(+n).prop("src",r).addClass("has_url")}),t.forEach(function(t,e){"editView"===t.attributeObj.type&&(t.viewData=$(e).find(".editView_main").html())})),!!i})}},{key:"getTemplate",value:function(){var t=this.templateBox.html();return this.templateContainer.html(t),this.templateContainer.find(".view-content").html(null),this.templateContainer.find(".bgSvg").html(null),{htmlStr:this.templateContainer.html(),box:this.templateContainer}}},{key:"throttle",value:function(t,e){var i=null,n=!0;return function(){var a=this,r=arguments;return n?(t.apply(a,r),n=!1):!i&&void(i=setTimeout(function(){window.clearTimeout(i),i=null,t.apply(a,r)},e))}}},{key:"getInitCellSize",value:function(){if(this.cellSize)return this.cellSize;var t=$("#viewTemplate"),e=t.width()/3+10,i=t.height()/3+10,n=+t.css("paddingTop").match(/\d+/g)[0],a=+t.css("paddingLeft").match(/\d+/g)[0];return this.cellSize={minWidth:e,minHeight:i,minTop:n,minLeft:a},this.cellSize}},{key:"createView",value:function(t,e,i){var n=this,a=this.config.templateMap,r=t.type,s=(t.borderType,t.size,["line","pie","scatter","bar","rader"].includes(r)?"chart":r),o={table:{getDataUrl:"getTableData",configName:"tabInfo"},timeReal:{getDataUrl:"getTableData",configName:"tabInfo"},chart:{getDataUrl:"getGraphData",configName:"graphInfo"},editView:{getDataUrl:"getAssembly"}}[s];l.api[o.getDataUrl](e).then(function(t){if(t){var e="editView"===s?"":t[o.configName].chartName,r="editView"===s?t.assembly_data:t;a.initAdd(i,e,r)}else n.config.unit.tipToast("没数据！",2),i.removeClass("view-fill"),a.remove(i)}).catch(function(t){n.config.unit.tipToast("组件获取出错,已删掉错误的组件！",0),a.remove(i)})}},{key:"renderTemplateViews",value:function(t){var e=this.config.templateMap,i=this,a=this.templateBox.find(".view-item");JSON.parse(t).map(function(t,r){var s=a[r],o=$(s);e.viewsMap.set(s,{attributeObj:n({createId:""},t),viewData:null,timer:null});var l,c,d,u=t.viewID;u&&(l=t,c=u,d=o,i.createView(l,c,d))})}},{key:"init",value:function(t){var i=this,n=this.config.viewDetail.layout_id,a=this.config.templateMap;o.api.showLayoutModel(n).then(function(t){var n="";if(t.model)n=t.model,i.box.html(n),i.viewDrop(),i.renderTemplateViews(t.modelData);else{n='<div class="view-template "  echo-theme="theme4" id="viewTemplate" style=\'grid-template-areas:\n\t\t\t\t    "t-left t-middle t-right"\n\t\t\t\t\t"m-left m-middle m-right"\n\t\t\t\t\t"b-left b-middle b-right ";\'>'+e.positionArr.map(function(t){return'<div class="view-item " draggable="true" id="'+t+'"  style="grid-area:'+t+'"></div>'}).join("")+"</div>",i.box.html(n);var r=Array.from(i.box.find(".view-item")),s=["left","middle","right"],o=["t","m","b"],l=e.positionArr.map(function(t){var e=t.split("-");return{size:[1,1],point:[s.indexOf(e[1]),o.indexOf(e[0]),t],viewID:"",borderType:"0",type:"",par:""}});a.init(r,l),i.viewDrop()}})}},{key:"showResizeBox",value:function(t){var e=t[0].offsetWidth+20,i=t[0].offsetHeight+20,n=t[0].offsetTop,a=t[0].offsetLeft;this.getInitCellSize(),this.curViewSize={curTop:n,curLeft:a,width:e,height:i},this.resiziEl.css({width:e,height:i,top:n,left:a})}},{key:"changeViewSize",value:function(t){var e=this.cellSize,i=e.minWidth,n=e.minHeight,a=this.resiziEl.width(),r=this.resiziEl.height(),s=Math.round(a/i),o=Math.round(r/n);this.changeStatus=!1;var l=$(".view-active"),c=this.config.templateMap.viewsMap.get(l[0]),d=c.attributeObj.size;s===d[0]&&o===d[1]||this.mergeCell([s,o],l,c)||(this.config.unit.tipToast("合并失败,请不要包含组件，以及与其他组件重叠！",0),this.resiziEl.hide())}},{key:"replaceView",value:function(t,e){var i=this.config.templateMap,n=e.split("@")[0],a=i.findViewByPoint(n),r=a.dom,s=a.value,o=$(r),l=s.viewData,c=s.attributeObj,d=c.type,u=c.borderType,h=(c.point,c.createId),p=c.viewID,f=i.viewsMap.get(t[0]),m=t.hasClass("view-fill");if(f.attributeObj.point[2]!==n){var v=f.viewData,b=f.attributeObj,y=b.type,w=b.borderType,g=b.createId,x=b.viewID,k=JSON.parse(JSON.stringify(v)),T=["line","pie","scatter","bar","rader"],C=T.includes(d)?"graphInfo":"tabInfo",_={borderType:u,type:d,viewTitle:"editView"!==d?l[C].chartName:"",createId:h,viewID:p};if(i.add(l,t,_,"replace"),m){var S=T.includes(y)?"graphInfo":"tabInfo",D={borderType:w,type:y,viewTitle:"editView"!==y?k[S].chartName:"",createId:g,viewID:x};i.add(k,o,D,"replace")}else s.attributeObj.viewID="",this.delViewData(o)}}},{key:"viewDrop",value:function(){var t=this.templateBox.find(".view-item"),e=Array.from(t),i=this.config.upModalStatus,n=this;e.map(function(t,e){t.ondragover=function(t){return t.stopPropagation(),t.preventDefault(),!0},t.ondrop=function(t){t.stopPropagation(),t.preventDefault();var e=$(this),a=t.dataTransfer.getData("type");a.includes("@")?n.replaceView(e,a):a&&!e.hasClass("view-fill")&&(e.addClass("view-active").siblings().removeClass("view-active"),i(a,e))},t.onselectstart=function(t){return!1},t.ondragstart=function(t){if(t.target.classList.contains("view-fill")){var e=n.config.templateMap.viewsMap.get(t.target).attributeObj.point[2]+"@";return t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("type",e),t.dataTransfer.setDragImage(t.target,0,0),!0}},t.ondragend=function(t){return t.dataTransfer.clearData("type"),!1}})}},{key:"delViewData",value:function(t){this.config.templateMap.remove(t)}},{key:"handle",value:function(){var t=this,e=t.templateBox,i=t.config.setModalSel;e.on("dblclick",".view-item",function(e){e.stopPropagation();var i=$(this);t.resiziEl.show(),i.addClass("view-active").siblings().removeClass("view-active"),t.showResizeBox(i)}),this.resiziEl.on("mousedown",".u-resize-icon",function(e){var i=$(this).attr("sign");t.resiziEl.attr("echo-direction",i),t.gLayout[0].onmousemove=t.throttle(function(e){t.move(e,i)},60),t.changeStatus=!0,t.startPointX=e.clientX,t.startPointY=e.clientY}),t.gLayout.on("mouseup",function(){t.gLayout[0].onmousemove=null,t.changeStatus&&t.changeViewSize()}),$(window).on("resize",function(){t.getInitCellSize()}),e.on("click",".btn-handle",function(){$(this).toggleClass("active")}),e.on("dblclick",".view-optBox ",function(t){t.stopPropagation()}),e.on("click",".view-btn",function(e){var n=$(this),a=n.attr("sign"),r=n.closest(".view-item");switch(a){case"expand":break;case"set":i(r);break;case"compress":break;case"remove":t.delViewData(r),r.html(null),r.removeClass("view-fill")}})}}]),e}();u.positionArr=["t-left","t-middle","t-right","m-left","m-middle","m-right","b-left","b-middle","b-right"],e.TemplateView=u},function(t,e){},function(t,e,i){"use strict";var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();i(15),i(47);var a=i(0),r=(i(13),i(46)),s=i(45),o=i(44),l=i(42),c=i(41),d=i(40),u=i(39),h=i(12);new(function(){function t(){var e=this;!function(e,i){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.modal=new a.SModal,this.inp=new a.SInp,this.unit=new a.Unit,this.templateMap=new c.TemplateMap,this.viewDetail=this.getSrcData();var i=this.modal,n=this.unit,h=this.templateMap;$("#viewTitle").html("<span>"+this.viewDetail.layout_name+"</span>"),this.viewSetModal=new o.ViewSetModal({modal:i,unit:n,templateMap:h}),this.TimeRealMd=new u.TimeRealMd({modal:i,unit:n,templateMap:h}),this.editViewMd=new d.Summernote({modal:i,unit:n,templateMap:h}),this.viewComponet=new l.ViewComponet,this.templateView=new r.TemplateView($("#templateBox"),{upModalStatus:function(t,i){switch(t){case"timeReal":e.TimeRealMd.upModalStatus(i);break;case"editView":e.editViewMd.upModalStatus(i);break;default:e.viewSetModal.upModalStatus(t,i)}},setModalSel:function(t){var i=h.viewsMap.get(t[0]);switch(i.attributeObj.type){case"timeReal":e.TimeRealMd.setModalSel(t,i);break;case"editView":e.editViewMd.setModalSel(t,i);break;default:e.viewSetModal.setModalSel(t)}},unit:n,templateMap:h,viewDetail:this.viewDetail}),new s.HeadOpt({modal:i,templateMap:h,unit:n,imgToUrl:function(t){return e.templateView.imgToUrl(t)},getTemplate:function(){return e.templateView.getTemplate()},viewDetail:this.viewDetail}),this.getData(),this.handle()}return n(t,[{key:"getSrcData",value:function(){var t=window.location.search.split("&&");return{layout_name:decodeURI(t[2].split("=")[1]),layout_id:t[0].split("=")[1],par_id:t[1].split("=")[1]}}},{key:"getData",value:function(){var t=this;return Promise.all([h.api.dimtree(),h.api.kpitree(),h.api.orgtree()]).then(function(e){var i=e[2].sub,n=e[1].sub,a=e[0].sub;Promise.resolve().then(function(e){t.viewSetModal.renderTreeData(i,n,a)}),Promise.resolve().then(function(e){t.TimeRealMd.renderTreeData(i,n,a)})})}},{key:"handle",value:function(){var t=this.templateView.resiziEl;$("#app").on("click",function(){t.hide()})}}]),t}())}],[[48,0,1]]]);
//# sourceMappingURL=editTemplate.chunk.js.map